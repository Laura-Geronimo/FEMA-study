

---
title: "Supplementary Information: Models"
author: "Laura Geronimo"
output:
  html_document:
    toc: true
    toc_depth: 6
    theme: united

---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r include=FALSE}
getwd()

##Libraries
library(dplyr)
library(stringr)
library(Hmisc)
library(tidycensus)
library(corrplot)
library(dplyr)
library(data.table)
library(ggplot2)
library(pastecs)
library(car)
library(gvlma)
library(qcc)
library(stargazer)

library(forcats)
library(boot)
library(fixest)
library(lmtest)
library(sandwich)

options (scipen=999)

#importing data
DNZ15 <- read.csv('C:/Users/lgero/Box/Research/FEMA_project/Data/Edited/HMA/DNZLevel/DNZ_V1/DNZ_V1.csv')
names(DNZ15)
DNZ15 <- DNZ15[,c(-1)]

#creating subsets
DNZ15_lessMix <- subset(DNZ15, felev==0 | felev==1)
DNZ15_After1993 <- subset(DNZ15, fyDeclared>1993)
DNZ15_WOSandy <- subset(DNZ15, Sandy==0)
DNZ15_WOKatrina <- subset(DNZ15, Katrina==0) 
DNZ15_CSC <- subset(DNZ15, CSC==1) 
DNZ15_ZCTA_shore <- subset(DNZ15, ZCTA_shore==1) 

DNZ15_Katrina <- subset(DNZ15, Katrina==1) 
DNZ15_Sandy <- subset(DNZ15, Sandy==1) 
DNZ15_Mix <- subset(DNZ15, felev>0 & felev<1)



```


#### Logistic Regression Modeling and Hypothesis testing:


## Logistic Regression Models: Full Sample (A Series)

##### Model Series A.0: Single variable model with FE for all explanatory vars:
```{r include= FALSE}

##M0: FE 
names(DNZ15)
M0 <- glm(felev~
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M0)

##testing for overdispersion
deviance(M0)/df.residual(M0)

##testing for multicollinearity
M0_Vif <- car::vif(M0) 
M0_Vif

#exponentiating coeff for ofyDeclareds ratios
M0Exp <- M0
M0Exp$coefficients <- exp(M0Exp$coefficients)
M0Exp

# pseudo R-squared
R0 <- (1-(M0$deviance)/(M0$null.deviance))
R0 <- round(R0,2)
R0


##M1: MHV
names(DNZ15)
M1 <- glm(felev~
            MHVadj_W_100k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1)

##testing for multicollinearity
M1_Vif <- car::vif(M1) 
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1

##M2: fWhite
names(DNZ15)
M2 <- glm(felev~
            fWhite +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2)

##testing for multicollinearity
M2_Vif <- car::vif(M2) 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2

##M3: RepRate
names(DNZ15)
M3 <- glm(felev~
            RepRate +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3)

##testing for multicollinearity
M3_Vif <- car::vif(M3) 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M4: ZCTA_shore
names(DNZ15)
M4 <- glm(felev~
            ZCTA_shore +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4)

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: FEMA SFHA
names(DNZ15)
M5 <- glm(felev~
            count_fema_sfha_W_1k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5)

##testing for multicollinearity
M5_Vif <- car::vif(M5) 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5

##M6: NFIP ICC
names(DNZ15)
M6 <- glm(felev~
            NFIP_ICCadj_YOLZ_W_1M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6)

##testing for multicollinearity
M6_Vif <- car::vif(M6) 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

##M7: NFIP IHP
names(DNZ15)
M7 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7)

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: Hurricane
names(DNZ15)
M8 <- glm(felev~
            Hurricane +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8)

##testing for multicollinearity
M8_Vif <- car::vif(M8) 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

##M9: Tot Pop
names(DNZ15)
M9 <- glm(felev~
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M9)

##testing for overdispersion
deviance(M9)/df.residual(M9)

##testing for multicollinearity
M9_Vif <- car::vif(M9) 
M9_Vif

#exponentiating coeff for ofyDeclareds ratios
M9Exp <- M9
M9Exp$coefficients <- exp(M9Exp$coefficients)
M9Exp

# pseudo R-squared
R9 <- (1-(M9$deviance)/(M9$null.deviance))
R9 <- round(R9,2)
R9


##M10: fOwnOcc
names(DNZ15)
M10 <- glm(felev~
            fOwnOcc +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M10)

##testing for overdispersion
deviance(M10)/df.residual(M10)

##testing for multicollinearity
M10_Vif <- car::vif(M10) 
M10_Vif

#exponentiating coeff for ofyDeclareds ratios
M10Exp <- M10
M10Exp$coefficients <- exp(M10Exp$coefficients)
M10Exp

# pseudo R-squared
R10 <- (1-(M10$deviance)/(M10$null.deviance))
R10 <- round(R10,2)
R10


#Model All
V1 <- stargazer(M0,M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,
                type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="C:/Users/lgero/Box/Research/FEMA_project/Results/myHMA10/DNZ_V1/DNZ_V1_felev_A0_SVM.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M0, M1, M2, M3, M4, M5, M6, M7, M8, M9, M10,
                type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: Full Sample (n=4334 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "NFIP ICC Claims 1M (W) by ZCTA-YOL",
                                     "IHP Damage Estimates 10M (W)",
                                     "Hurricane",
                                     "Total Population 10k (W)",
                                     "Fraction of Owner Occ. HUs"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series A.1 (Testing 5 hypotheses against baseline)
```{r include= FALSE}
##M1: Baseline:  Damages, TotPopW_10k, + State FE 
names(DNZ15)
M1 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1) #0.53

##testing for multicollinearity
M1_Vif <- car::vif(M1) #good
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1


#M2: MHV + Baseline
names(DNZ15)
M2 <- glm(felev~
            MHVadj_W_100k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k + 
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.81

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)

#pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2


#M3: fWhite + Baseline
names(DNZ15)
M3 <- glm(felev~
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.87

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)

#pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

#M4: Both: MHV + fWhite + Baseline
M4 <- glm(felev~
            MHVadj_W_100k+ 
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.81

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: RepRate + Baseline
names(DNZ15)
M5 <- glm(felev~
            RepRate +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.87

##testing for multicollinearity

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M6: ZCTA_shore + Baseline
names(DNZ15)
M6 <- glm(felev~
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG)  +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.66

##testing for multicollinearity


#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


#M7: SFHA + baseline
M7 <- glm(felev~
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.81

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: All + Baseline (w year FEs)
names(DNZ15)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

#Model All
V1 <- stargazer(M1,M2,M3,M4,M5,M6,M7,M8, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Pseudo $R2$", R1, R2, R3, R4, R5, R6, R7, R8)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_A1_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M1, M2, M3, M4, M5, M6, M7, M8, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: Full Sample (n=4334 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Pseudo $R2$",  R1, R2, R3, R4, R5, R6, R7, R8)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series A.2 (Starting with best model from above (M8) and dropping vars)
```{r include= FALSE}
##M8: All + Baseline (w year FEs)
names(DNZ15)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8


##M7: dropping MHV
names(DNZ15)
M7 <- glm(felev~
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.6

##testing for multicollinearity
M7_Vif <- car::vif(M7) ## 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7


## Dropping fWhite
M6 <- glm(felev~
            MHVadj_W_100k +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.6

##testing for multicollinearity
M6_Vif <- car::vif(M6) ## 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


##M5: dropping RepRate
names(DNZ15)
M5 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.6

##testing for multicollinearity
M5_Vif <- car::vif(M5) ## 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M4: dropping ZCTA_shore
names(DNZ15)
M4 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.6

##testing for multicollinearity
M4_Vif <- car::vif(M4) ## 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M3: dropping Count FEMA SFHA
names(DNZ15)
M3 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.6

##testing for multicollinearity
M3_Vif <- car::vif(M3) ## 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M2: Dropping all hypothesis vase
names(DNZ15)
M2 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.6

##testing for multicollinearity
M2_Vif <- car::vif(M2) ## 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2



#Model All
V1 <- stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R8, R7, R6, R5, R4, R3, R2)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_A2_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: Full Sample (n=4334 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Pseudo $R2$",  R8, R7, R6, R5, R4, R3, R2)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```




## Logistic Regression Models: "Less Mix" Sample (B series)

##### Model Series B.0: Single variable model with FE for all explanatory vars:
```{r include= FALSE}

##M0: FE 
names(DNZ15_lessMix)
M0 <- glm(felev~
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M0)

##testing for overdispersion
deviance(M0)/df.residual(M0)

##testing for multicollinearity
M0_Vif <- car::vif(M0) 
M0_Vif

#exponentiating coeff for ofyDeclareds ratios
M0Exp <- M0
M0Exp$coefficients <- exp(M0Exp$coefficients)
M0Exp

# pseudo R-squared
R0 <- (1-(M0$deviance)/(M0$null.deviance))
R0 <- round(R0,2)
R0


##M1: MHV
names(DNZ15_lessMix)
M1 <- glm(felev~
            MHVadj_W_100k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1)

##testing for multicollinearity
M1_Vif <- car::vif(M1) 
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1

##M2: fWhite
names(DNZ15_lessMix)
M2 <- glm(felev~
            fWhite +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2)

##testing for multicollinearity
M2_Vif <- car::vif(M2) 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2

##M3: RepRate
names(DNZ15_lessMix)
M3 <- glm(felev~
            RepRate +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3)

##testing for multicollinearity
M3_Vif <- car::vif(M3) 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M4: ZCTA_shore
names(DNZ15_lessMix)
M4 <- glm(felev~
            ZCTA_shore +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4)

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: FEMA SFHA
names(DNZ15_lessMix)
M5 <- glm(felev~
            count_fema_sfha_W_1k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5)

##testing for multicollinearity
M5_Vif <- car::vif(M5) 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5

##M6: NFIP ICC
names(DNZ15_lessMix)
M6 <- glm(felev~
            NFIP_ICCadj_YOLZ_W_1M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6)

##testing for multicollinearity
M6_Vif <- car::vif(M6) 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

##M7: NFIP IHP
names(DNZ15_lessMix)
M7 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7)

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: Hurricane
names(DNZ15_lessMix)
M8 <- glm(felev~
            Hurricane +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8)

##testing for multicollinearity
M8_Vif <- car::vif(M8) 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

##M9: Tot Pop
names(DNZ15_lessMix)
M9 <- glm(felev~
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M9)

##testing for overdispersion
deviance(M9)/df.residual(M9)

##testing for multicollinearity
M9_Vif <- car::vif(M9) 
M9_Vif

#exponentiating coeff for ofyDeclareds ratios
M9Exp <- M9
M9Exp$coefficients <- exp(M9Exp$coefficients)
M9Exp

# pseudo R-squared
R9 <- (1-(M9$deviance)/(M9$null.deviance))
R9 <- round(R9,2)
R9


##M10: fOwnOcc
names(DNZ15_lessMix)
M10 <- glm(felev~
            fOwnOcc +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M10)

##testing for overdispersion
deviance(M10)/df.residual(M10)

##testing for multicollinearity
M10_Vif <- car::vif(M10) 
M10_Vif

#exponentiating coeff for ofyDeclareds ratios
M10Exp <- M10
M10Exp$coefficients <- exp(M10Exp$coefficients)
M10Exp

# pseudo R-squared
R10 <- (1-(M10$deviance)/(M10$null.deviance))
R10 <- round(R10,2)
R10


#Model All
V1 <- stargazer(M0,M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,
                type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_B0_SVM.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M0, M1, M2, M3, M4, M5, M6, M7, M8, M9, M10,
                type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'Less Mix' Sample (n=4117 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "NFIP ICC Claims 1M (W) by ZCTA-YOL",
                                     "IHP Damage Estimates 10M (W)",
                                     "Hurricane",
                                     "Total Population 10k (W)",
                                     "Fraction of Owner Occ. HUs"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series B.1 (Testing 5 hypotheses against baseline)
```{r include= FALSE}
##M1: Baseline:  Damages, TotPopW_10k, + State FE 
names(DNZ15_lessMix)
M1 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1) #0.53

##testing for multicollinearity
M1_Vif <- car::vif(M1) #good
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1


#M2: MHV + Baseline
names(DNZ15_lessMix)
M2 <- glm(felev~
            MHVadj_W_100k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k + 
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.81

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)

#pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2


#M3: fWhite + Baseline
names(DNZ15_lessMix)
M3 <- glm(felev~
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.87

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)

#pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

#M4: Both: MHV + fWhite + Baseline
M4 <- glm(felev~
            MHVadj_W_100k+ 
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.81

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: RepRate + Baseline
names(DNZ15_lessMix)
M5 <- glm(felev~
            RepRate +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.87

##testing for multicollinearity

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M6: ZCTA_shore + Baseline
names(DNZ15_lessMix)
M6 <- glm(felev~
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG)  +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.66

##testing for multicollinearity


#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


#M7: SFHA + baseline
M7 <- glm(felev~
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.81

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: All + Baseline (w year FEs)
names(DNZ15_lessMix)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

#Model All
V1 <- stargazer(M1,M2,M3,M4,M5,M6,M7,M8, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Pseudo $R2$", R1, R2, R3, R4, R5, R6, R7, R8)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_B1_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M1, M2, M3, M4, M5, M6, M7, M8, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'Less Mix' Sample (n=4117 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Pseudo $R2$",  R1, R2, R3, R4, R5, R6, R7, R8)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series B.2 (Starting with best model from above (M8) and dropping vars)
```{r include= FALSE}
##M8: All + Baseline (w year FEs)
names(DNZ15_lessMix)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8


##M7: dropping MHV
names(DNZ15_lessMix)
M7 <- glm(felev~
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.6

##testing for multicollinearity
M7_Vif <- car::vif(M7) ## 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7


## Dropping fWhite
M6 <- glm(felev~
            MHVadj_W_100k +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.6

##testing for multicollinearity
M6_Vif <- car::vif(M6) ## 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


##M5: dropping RepRate
names(DNZ15_lessMix)
M5 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.6

##testing for multicollinearity
M5_Vif <- car::vif(M5) ## 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M4: dropping ZCTA_shore
names(DNZ15_lessMix)
M4 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.6

##testing for multicollinearity
M4_Vif <- car::vif(M4) ## 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M3: dropping Count FEMA SFHA
names(DNZ15_lessMix)
M3 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.6

##testing for multicollinearity
M3_Vif <- car::vif(M3) ## 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M2: Dropping all hypothesis vase
names(DNZ15_lessMix)
M2 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.6

##testing for multicollinearity
M2_Vif <- car::vif(M2) ## 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2



#Model All
V1 <- stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R8, R7, R6, R5, R4, R3, R2)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_B2_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'Less Mix' Sample (n=4117 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Pseudo $R2$",  R8, R7, R6, R5, R4, R3, R2)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```

The model without fWhite (3) has the lowest AIC.


## Logistic Regression Models: "After 1993" Sample (C series)

##### Model Series C.0: Single variable model with FE for all explanatory vars:
```{r include= FALSE}

##M0: FE 
names(DNZ15_After1993)
M0 <- glm(felev~
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M0)

##testing for overdispersion
deviance(M0)/df.residual(M0)

##testing for multicollinearity
M0_Vif <- car::vif(M0) 
M0_Vif

#exponentiating coeff for ofyDeclareds ratios
M0Exp <- M0
M0Exp$coefficients <- exp(M0Exp$coefficients)
M0Exp

# pseudo R-squared
R0 <- (1-(M0$deviance)/(M0$null.deviance))
R0 <- round(R0,2)
R0


##M1: MHV
names(DNZ15_After1993)
M1 <- glm(felev~
            MHVadj_W_100k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1)

##testing for multicollinearity
M1_Vif <- car::vif(M1) 
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1

##M2: fWhite
names(DNZ15_After1993)
M2 <- glm(felev~
            fWhite +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2)

##testing for multicollinearity
M2_Vif <- car::vif(M2) 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2

##M3: RepRate
names(DNZ15_After1993)
M3 <- glm(felev~
            RepRate +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3)

##testing for multicollinearity
M3_Vif <- car::vif(M3) 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M4: ZCTA_shore
names(DNZ15_After1993)
M4 <- glm(felev~
            ZCTA_shore +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4)

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: FEMA SFHA
names(DNZ15_After1993)
M5 <- glm(felev~
            count_fema_sfha_W_1k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5)

##testing for multicollinearity
M5_Vif <- car::vif(M5) 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5

##M6: NFIP ICC
names(DNZ15_After1993)
M6 <- glm(felev~
            NFIP_ICCadj_YOLZ_W_1M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6)

##testing for multicollinearity
M6_Vif <- car::vif(M6) 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

##M7: NFIP IHP
names(DNZ15_After1993)
M7 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7)

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: Hurricane
names(DNZ15_After1993)
M8 <- glm(felev~
            Hurricane +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8)

##testing for multicollinearity
M8_Vif <- car::vif(M8) 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

##M9: Tot Pop
names(DNZ15_After1993)
M9 <- glm(felev~
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M9)

##testing for overdispersion
deviance(M9)/df.residual(M9)

##testing for multicollinearity
M9_Vif <- car::vif(M9) 
M9_Vif

#exponentiating coeff for ofyDeclareds ratios
M9Exp <- M9
M9Exp$coefficients <- exp(M9Exp$coefficients)
M9Exp

# pseudo R-squared
R9 <- (1-(M9$deviance)/(M9$null.deviance))
R9 <- round(R9,2)
R9


##M10: fOwnOcc
names(DNZ15_After1993)
M10 <- glm(felev~
            fOwnOcc +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M10)

##testing for overdispersion
deviance(M10)/df.residual(M10)

##testing for multicollinearity
M10_Vif <- car::vif(M10) 
M10_Vif

#exponentiating coeff for ofyDeclareds ratios
M10Exp <- M10
M10Exp$coefficients <- exp(M10Exp$coefficients)
M10Exp

# pseudo R-squared
R10 <- (1-(M10$deviance)/(M10$null.deviance))
R10 <- round(R10,2)
R10


#Model All
V1 <- stargazer(M0,M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,
                type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_C0_SVM.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M0, M1, M2, M3, M4, M5, M6, M7, M8, M9, M10,
                type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'After 1993' Sample (n=4076 DNZs)" , 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "NFIP ICC Claims 1M (W) by ZCTA-YOL",
                                     "IHP Damage Estimates 10M (W)",
                                     "Hurricane",
                                     "Total Population 10k (W)",
                                     "Fraction of Owner Occ. HUs"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series C.1 (Testing 5 hypotheses against baseline)
```{r include= FALSE}
##M1: Baseline:  Damages, TotPopW_10k, + State FE 
names(DNZ15_After1993)
M1 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1) #0.53

##testing for multicollinearity
M1_Vif <- car::vif(M1) #good
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1


#M2: MHV + Baseline
names(DNZ15_After1993)
M2 <- glm(felev~
            MHVadj_W_100k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k + 
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.81

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)

#pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2


#M3: fWhite + Baseline
names(DNZ15_After1993)
M3 <- glm(felev~
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.87

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)

#pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

#M4: Both: MHV + fWhite + Baseline
M4 <- glm(felev~
            MHVadj_W_100k+ 
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.81

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: RepRate + Baseline
names(DNZ15_After1993)
M5 <- glm(felev~
            RepRate +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.87

##testing for multicollinearity

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M6: ZCTA_shore + Baseline
names(DNZ15_After1993)
M6 <- glm(felev~
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG)  +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.66

##testing for multicollinearity


#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


#M7: SFHA + baseline
M7 <- glm(felev~
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.81

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: All + Baseline (w year FEs)
names(DNZ15_After1993)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

#Model All
V1 <- stargazer(M1,M2,M3,M4,M5,M6,M7,M8, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Pseudo $R2$", R1, R2, R3, R4, R5, R6, R7, R8)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_C1_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M1, M2, M3, M4, M5, M6, M7, M8, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'After 1993' Sample (n=4076 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Pseudo $R2$",  R1, R2, R3, R4, R5, R6, R7, R8)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series C.2 (Starting with best model from above (M8) and dropping vars)
```{r include= FALSE}
##M8: All + Baseline (w year FEs)
names(DNZ15_After1993)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8


##M7: dropping MHV
names(DNZ15_After1993)
M7 <- glm(felev~
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.6

##testing for multicollinearity
M7_Vif <- car::vif(M7) ## 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7


## Dropping fWhite
M6 <- glm(felev~
            MHVadj_W_100k +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.6

##testing for multicollinearity
M6_Vif <- car::vif(M6) ## 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


##M5: dropping RepRate
names(DNZ15_After1993)
M5 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.6

##testing for multicollinearity
M5_Vif <- car::vif(M5) ## 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M4: dropping ZCTA_shore
names(DNZ15_After1993)
M4 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.6

##testing for multicollinearity
M4_Vif <- car::vif(M4) ## 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M3: dropping Count FEMA SFHA
names(DNZ15_After1993)
M3 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.6

##testing for multicollinearity
M3_Vif <- car::vif(M3) ## 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M2: Dropping all hypothesis vase
names(DNZ15_After1993)
M2 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.6

##testing for multicollinearity
M2_Vif <- car::vif(M2) ## 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2



#Model All
V1 <- stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R8, R7, R6, R5, R4, R3, R2)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_C2_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'After 1993' Sample (n=4076 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Pseudo $R2$",  R8, R7, R6, R5, R4, R3, R2)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```

The model without fWhite (3) has the lowest AIC.



## Logistic Regression Models: "Without Sandy" Sample (D series)

##### Model Series D.0: Single variable model with FE for all explanatory vars:
```{r include= FALSE}

##M0: FE 
names(DNZ15_WOSandy)
M0 <- glm(felev~
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M0)

##testing for overdispersion
deviance(M0)/df.residual(M0)

##testing for multicollinearity
M0_Vif <- car::vif(M0) 
M0_Vif

#exponentiating coeff for ofyDeclareds ratios
M0Exp <- M0
M0Exp$coefficients <- exp(M0Exp$coefficients)
M0Exp

# pseudo R-squared
R0 <- (1-(M0$deviance)/(M0$null.deviance))
R0 <- round(R0,2)
R0


##M1: MHV
names(DNZ15_WOSandy)
M1 <- glm(felev~
            MHVadj_W_100k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1)

##testing for multicollinearity
M1_Vif <- car::vif(M1) 
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1

##M2: fWhite
names(DNZ15_WOSandy)
M2 <- glm(felev~
            fWhite +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2)

##testing for multicollinearity
M2_Vif <- car::vif(M2) 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2

##M3: RepRate
names(DNZ15_WOSandy)
M3 <- glm(felev~
            RepRate +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3)

##testing for multicollinearity
M3_Vif <- car::vif(M3) 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M4: ZCTA_shore
names(DNZ15_WOSandy)
M4 <- glm(felev~
            ZCTA_shore +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4)

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: FEMA SFHA
names(DNZ15_WOSandy)
M5 <- glm(felev~
            count_fema_sfha_W_1k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5)

##testing for multicollinearity
M5_Vif <- car::vif(M5) 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5

##M6: NFIP ICC
names(DNZ15_WOSandy)
M6 <- glm(felev~
            NFIP_ICCadj_YOLZ_W_1M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6)

##testing for multicollinearity
M6_Vif <- car::vif(M6) 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

##M7: NFIP IHP
names(DNZ15_WOSandy)
M7 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7)

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: Hurricane
names(DNZ15_WOSandy)
M8 <- glm(felev~
            Hurricane +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8)

##testing for multicollinearity
M8_Vif <- car::vif(M8) 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

##M9: Tot Pop
names(DNZ15_WOSandy)
M9 <- glm(felev~
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M9)

##testing for overdispersion
deviance(M9)/df.residual(M9)

##testing for multicollinearity
M9_Vif <- car::vif(M9) 
M9_Vif

#exponentiating coeff for ofyDeclareds ratios
M9Exp <- M9
M9Exp$coefficients <- exp(M9Exp$coefficients)
M9Exp

# pseudo R-squared
R9 <- (1-(M9$deviance)/(M9$null.deviance))
R9 <- round(R9,2)
R9


##M10: fOwnOcc
names(DNZ15_WOSandy)
M10 <- glm(felev~
            fOwnOcc +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M10)

##testing for overdispersion
deviance(M10)/df.residual(M10)

##testing for multicollinearity
M10_Vif <- car::vif(M10) 
M10_Vif

#exponentiating coeff for ofyDeclareds ratios
M10Exp <- M10
M10Exp$coefficients <- exp(M10Exp$coefficients)
M10Exp

# pseudo R-squared
R10 <- (1-(M10$deviance)/(M10$null.deviance))
R10 <- round(R10,2)
R10


#Model All
V1 <- stargazer(M0,M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,
                type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_D0_SVM.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M0, M1, M2, M3, M4, M5, M6, M7, M8, M9, M10,
                type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'Without Sandy' Sample (n=4221 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "NFIP ICC Claims 1M (W) by ZCTA-YOL",
                                     "IHP Damage Estimates 10M (W)",
                                     "Hurricane",
                                     "Total Population 10k (W)",
                                     "Fraction of Owner Occ. HUs"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series D.1 (Testing 5 hypotheses against baseline)
```{r include= FALSE}
##M1: Baseline:  Damages, TotPopW_10k, + State FE 
names(DNZ15_WOSandy)
M1 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1) #0.53

##testing for multicollinearity
M1_Vif <- car::vif(M1) #good
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1


#M2: MHV + Baseline
names(DNZ15_WOSandy)
M2 <- glm(felev~
            MHVadj_W_100k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k + 
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.81

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)

#pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2


#M3: fWhite + Baseline
names(DNZ15_WOSandy)
M3 <- glm(felev~
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.87

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)

#pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

#M4: Both: MHV + fWhite + Baseline
M4 <- glm(felev~
            MHVadj_W_100k+ 
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.81

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: RepRate + Baseline
names(DNZ15_WOSandy)
M5 <- glm(felev~
            RepRate +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.87

##testing for multicollinearity

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M6: ZCTA_shore + Baseline
names(DNZ15_WOSandy)
M6 <- glm(felev~
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG)  +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.66

##testing for multicollinearity


#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


#M7: SFHA + baseline
M7 <- glm(felev~
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.81

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: All + Baseline (w year FEs)
names(DNZ15_WOSandy)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

#Model All
V1 <- stargazer(M1,M2,M3,M4,M5,M6,M7,M8, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Pseudo $R2$", R1, R2, R3, R4, R5, R6, R7, R8)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_D1_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M1, M2, M3, M4, M5, M6, M7, M8, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'Without Sandy' Sample (n=4221 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Pseudo $R2$",  R1, R2, R3, R4, R5, R6, R7, R8)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series D.2 (Starting with best model from above (M8) and dropping vars)
```{r include= FALSE}
##M8: All + Baseline (w year FEs)
names(DNZ15_WOSandy)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8


##M7: dropping MHV
names(DNZ15_WOSandy)
M7 <- glm(felev~
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.6

##testing for multicollinearity
M7_Vif <- car::vif(M7) ## 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7


## Dropping fWhite
M6 <- glm(felev~
            MHVadj_W_100k +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.6

##testing for multicollinearity
M6_Vif <- car::vif(M6) ## 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


##M5: dropping RepRate
names(DNZ15_WOSandy)
M5 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.6

##testing for multicollinearity
M5_Vif <- car::vif(M5) ## 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M4: dropping ZCTA_shore
names(DNZ15_WOSandy)
M4 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.6

##testing for multicollinearity
M4_Vif <- car::vif(M4) ## 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M3: dropping Count FEMA SFHA
names(DNZ15_WOSandy)
M3 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.6

##testing for multicollinearity
M3_Vif <- car::vif(M3) ## 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M2: Dropping all hypothesis vase
names(DNZ15_WOSandy)
M2 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.6

##testing for multicollinearity
M2_Vif <- car::vif(M2) ## 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2



#Model All
V1 <- stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R8, R7, R6, R5, R4, R3, R2)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_D2_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'Without Sandy' Sample (n=4221 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Pseudo $R2$",  R8, R7, R6, R5, R4, R3, R2)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```

The model without fWhite (3) has the lowest AIC.


## Logistic Regression Models: "Without Katrina" Sample (E series)

##### Model Series E.0: Single variable model with FE for all explanatory vars:
```{r include= FALSE}

##M0: FE 
names(DNZ15_WOKatrina)
M0 <- glm(felev~
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M0)

##testing for overdispersion
deviance(M0)/df.residual(M0)

##testing for multicollinearity
M0_Vif <- car::vif(M0) 
M0_Vif

#exponentiating coeff for ofyDeclareds ratios
M0Exp <- M0
M0Exp$coefficients <- exp(M0Exp$coefficients)
M0Exp

# pseudo R-squared
R0 <- (1-(M0$deviance)/(M0$null.deviance))
R0 <- round(R0,2)
R0


##M1: MHV
names(DNZ15_WOKatrina)
M1 <- glm(felev~
            MHVadj_W_100k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1)

##testing for multicollinearity
M1_Vif <- car::vif(M1) 
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1

##M2: fWhite
names(DNZ15_WOKatrina)
M2 <- glm(felev~
            fWhite +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2)

##testing for multicollinearity
M2_Vif <- car::vif(M2) 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2

##M3: RepRate
names(DNZ15_WOKatrina)
M3 <- glm(felev~
            RepRate +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3)

##testing for multicollinearity
M3_Vif <- car::vif(M3) 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M4: ZCTA_shore
names(DNZ15_WOKatrina)
M4 <- glm(felev~
            ZCTA_shore +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4)

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: FEMA SFHA
names(DNZ15_WOKatrina)
M5 <- glm(felev~
            count_fema_sfha_W_1k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5)

##testing for multicollinearity
M5_Vif <- car::vif(M5) 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5

##M6: NFIP ICC
names(DNZ15_WOKatrina)
M6 <- glm(felev~
            NFIP_ICCadj_YOLZ_W_1M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6)

##testing for multicollinearity
M6_Vif <- car::vif(M6) 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

##M7: NFIP IHP
names(DNZ15_WOKatrina)
M7 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7)

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: Hurricane
names(DNZ15_WOKatrina)
M8 <- glm(felev~
            Hurricane +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8)

##testing for multicollinearity
M8_Vif <- car::vif(M8) 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

##M9: Tot Pop
names(DNZ15_WOKatrina)
M9 <- glm(felev~
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M9)

##testing for overdispersion
deviance(M9)/df.residual(M9)

##testing for multicollinearity
M9_Vif <- car::vif(M9) 
M9_Vif

#exponentiating coeff for ofyDeclareds ratios
M9Exp <- M9
M9Exp$coefficients <- exp(M9Exp$coefficients)
M9Exp

# pseudo R-squared
R9 <- (1-(M9$deviance)/(M9$null.deviance))
R9 <- round(R9,2)
R9


##M10: fOwnOcc
names(DNZ15_WOKatrina)
M10 <- glm(felev~
            fOwnOcc +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M10)

##testing for overdispersion
deviance(M10)/df.residual(M10)

##testing for multicollinearity
M10_Vif <- car::vif(M10) 
M10_Vif

#exponentiating coeff for ofyDeclareds ratios
M10Exp <- M10
M10Exp$coefficients <- exp(M10Exp$coefficients)
M10Exp

# pseudo R-squared
R10 <- (1-(M10$deviance)/(M10$null.deviance))
R10 <- round(R10,2)
R10


#Model All
V1 <- stargazer(M0,M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,
                type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_E0_SVM.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M0, M1, M2, M3, M4, M5, M6, M7, M8, M9, M10,
                type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'Without Katrina' Sample (n=4215 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "NFIP ICC Claims 1M (W) by ZCTA-YOL",
                                     "IHP Damage Estimates 10M (W)",
                                     "Hurricane",
                                     "Total Population 10k (W)",
                                     "Fraction of Owner Occ. HUs"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series E.1 (Testing 5 hypotheses against baseline)
```{r include= FALSE}
##M1: Baseline:  Damages, TotPopW_10k, + State FE 
names(DNZ15_WOKatrina)
M1 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1) #0.53

##testing for multicollinearity
M1_Vif <- car::vif(M1) #good
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1


#M2: MHV + Baseline
names(DNZ15_WOKatrina)
M2 <- glm(felev~
            MHVadj_W_100k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k + 
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.81

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)

#pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2


#M3: fWhite + Baseline
names(DNZ15_WOKatrina)
M3 <- glm(felev~
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.87

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)

#pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

#M4: Both: MHV + fWhite + Baseline
M4 <- glm(felev~
            MHVadj_W_100k+ 
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.81

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: RepRate + Baseline
names(DNZ15_WOKatrina)
M5 <- glm(felev~
            RepRate +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.87

##testing for multicollinearity

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M6: ZCTA_shore + Baseline
names(DNZ15_WOKatrina)
M6 <- glm(felev~
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG)  +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.66

##testing for multicollinearity


#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


#M7: SFHA + baseline
M7 <- glm(felev~
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.81

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: All + Baseline (w year FEs)
names(DNZ15_WOKatrina)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

#Model All
V1 <- stargazer(M1,M2,M3,M4,M5,M6,M7,M8, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Pseudo $R2$", R1, R2, R3, R4, R5, R6, R7, R8)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_E1_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M1, M2, M3, M4, M5, M6, M7, M8, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'Without Katrina' Sample (n=4215 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES","YES","YES", "YES"),
                                 c("Pseudo $R2$",  R1, R2, R3, R4, R5, R6, R7, R8)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series E.2 (Starting with best model from above (M8) and dropping vars)
```{r include= FALSE}
##M8: All + Baseline (w year FEs)
names(DNZ15_WOKatrina)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8


##M7: dropping MHV
names(DNZ15_WOKatrina)
M7 <- glm(felev~
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.6

##testing for multicollinearity
M7_Vif <- car::vif(M7) ## 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7


## Dropping fWhite
M6 <- glm(felev~
            MHVadj_W_100k +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.6

##testing for multicollinearity
M6_Vif <- car::vif(M6) ## 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


##M5: dropping RepRate
names(DNZ15_WOKatrina)
M5 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.6

##testing for multicollinearity
M5_Vif <- car::vif(M5) ## 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M4: dropping ZCTA_shore
names(DNZ15_WOKatrina)
M4 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.6

##testing for multicollinearity
M4_Vif <- car::vif(M4) ## 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M3: dropping Count FEMA SFHA
names(DNZ15_WOKatrina)
M3 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.6

##testing for multicollinearity
M3_Vif <- car::vif(M3) ## 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M2: Dropping all hypothesis vase
names(DNZ15_WOKatrina)
M2 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.6

##testing for multicollinearity
M2_Vif <- car::vif(M2) ## 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2



#Model All
V1 <- stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R8, R7, R6, R5, R4, R3, R2)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_E2_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'Without Katrina' Sample (n=4215 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Pseudo $R2$",  R8, R7, R6, R5, R4, R3, R2)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```

The model without fWhite (3) has the lowest AIC.




## Logistic Regression Models: "CSC" Sample (F series)

##### Model Series F.0: Single variable model with FE for all explanatory vars:
```{r include= FALSE}

##M0: FE 
names(DNZ15_CSC)
M0 <- glm(felev~
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M0)

##testing for overdispersion
deviance(M0)/df.residual(M0)

##testing for multicollinearity
M0_Vif <- car::vif(M0) 
M0_Vif

#exponentiating coeff for ofyDeclareds ratios
M0Exp <- M0
M0Exp$coefficients <- exp(M0Exp$coefficients)
M0Exp

# pseudo R-squared
R0 <- (1-(M0$deviance)/(M0$null.deviance))
R0 <- round(R0,2)
R0


##M1: MHV
names(DNZ15_CSC)
M1 <- glm(felev~
            MHVadj_W_100k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1)

##testing for multicollinearity
M1_Vif <- car::vif(M1) 
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1

##M2: fWhite
names(DNZ15_CSC)
M2 <- glm(felev~
            fWhite +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2)

##testing for multicollinearity
M2_Vif <- car::vif(M2) 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2

##M3: RepRate
names(DNZ15_CSC)
M3 <- glm(felev~
            RepRate +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3)

##testing for multicollinearity
M3_Vif <- car::vif(M3) 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3


##M4: ZCTA_shore
names(DNZ15_CSC)
M4 <- glm(felev~
            ZCTA_shore +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4)

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: FEMA SFHA
names(DNZ15_CSC)
M5 <- glm(felev~
            count_fema_sfha_W_1k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5)

##testing for multicollinearity
M5_Vif <- car::vif(M5) 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5

##M6: NFIP ICC
names(DNZ15_CSC)
M6 <- glm(felev~
            NFIP_ICCadj_YOLZ_W_1M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6)

##testing for multicollinearity
M6_Vif <- car::vif(M6) 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

##M7: NFIP IHP
names(DNZ15_CSC)
M7 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7)

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: Hurricane
names(DNZ15_CSC)
M8 <- glm(felev~
            Hurricane +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8)

##testing for multicollinearity
M8_Vif <- car::vif(M8) 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

##M9: Tot Pop
names(DNZ15_CSC)
M9 <- glm(felev~
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M9)

##testing for overdispersion
deviance(M9)/df.residual(M9)

##testing for multicollinearity
M9_Vif <- car::vif(M9) 
M9_Vif

#exponentiating coeff for ofyDeclareds ratios
M9Exp <- M9
M9Exp$coefficients <- exp(M9Exp$coefficients)
M9Exp

# pseudo R-squared
R9 <- (1-(M9$deviance)/(M9$null.deviance))
R9 <- round(R9,2)
R9


##M10: fOwnOcc
names(DNZ15_CSC)
M10 <- glm(felev~
            fOwnOcc +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M10)

##testing for overdispersion
deviance(M10)/df.residual(M10)

##testing for multicollinearity
M10_Vif <- car::vif(M10) 
M10_Vif

#exponentiating coeff for ofyDeclareds ratios
M10Exp <- M10
M10Exp$coefficients <- exp(M10Exp$coefficients)
M10Exp

# pseudo R-squared
R10 <- (1-(M10$deviance)/(M10$null.deviance))
R10 <- round(R10,2)
R10


#Model All
V1 <- stargazer(M0,M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,
                type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3,R4, R5, R6, R7, R8, R9, R10)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_F0_SVM.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M0, M1, M2, M3,M4, M5, M6, M7, M8, M9, M10,
                type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'ZCTA_shore' Sample (n=1324 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3, R4,R5, R6, R7, R8, R9, R10)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "NFIP ICC Claims 1M (W) by ZCTA-YOL",
                                     "IHP Damage Estimates 10M (W)",
                                     "Hurricane",
                                     "Total Population 10k (W)",
                                     "Fraction of Owner Occ. HUs"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series F.1 (Testing 5 hypotheses against baseline)
```{r include= FALSE}
##M1: Baseline:  Damages, TotPopW_10k, + State FE 
names(DNZ15_CSC)
M1 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1) #0.53

##testing for multicollinearity
M1_Vif <- car::vif(M1) #good
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1


#M2: MHV + Baseline
names(DNZ15_CSC)
M2 <- glm(felev~
            MHVadj_W_100k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k + 
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.81

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)

#pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2


#M3: fWhite + Baseline
names(DNZ15_CSC)
M3 <- glm(felev~
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.87

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)

#pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

#M4: Both: MHV + fWhite + Baseline
M4 <- glm(felev~
            MHVadj_W_100k+ 
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.81

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: ZCTA_shore + Baseline
names(DNZ15_CSC)
M5 <- glm(felev~
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.87

##testing for multicollinearity

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5



##M6: RepRate + Baseline
names(DNZ15_CSC)
M6 <- glm(felev~
            RepRate +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.87

##testing for multicollinearity

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

#M7: SFHA + baseline
M7 <- glm(felev~
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.81

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: All + Baseline (w year FEs)
names(DNZ15_CSC)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

#Model All
V1 <- stargazer(M1,M2,M3,M4,M5,M6,M7,M8, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES", "YES", "YES","YES","YES", "YES", "YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES", "YES", "YES"),
                                 c("Pseudo $R2$", R1, R2, R3, R4, R5, R6,R7, R8)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_F1_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M1, M2, M3, M4, M5, M6,M7, M8, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'ZCTA_shore' Sample (n=1324 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES", "YES", "YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES","YES", "YES", "YES"),
                                 c("Pseudo $R2$",  R1, R2, R3, R4, R5,R6, R7, R8)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series F.2 (Starting with best model from above (M8) and dropping vars)
```{r include= FALSE}
##M8: All + Baseline (w year FEs)
names(DNZ15_CSC)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8


##M7: dropping MHV
names(DNZ15_CSC)
M7 <- glm(felev~
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.6

##testing for multicollinearity
M7_Vif <- car::vif(M7) ## 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7


## Dropping fWhite
M6 <- glm(felev~
            MHVadj_W_100k +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.6

##testing for multicollinearity
M6_Vif <- car::vif(M6) ## 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


##M5: dropping RepRate
names(DNZ15_CSC)
M5 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.6

##testing for multicollinearity
M5_Vif <- car::vif(M5) ## 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5

##M4: dropping ZCTA_shore
names(DNZ15_CSC)
M4 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.6

##testing for multicollinearity
M4_Vif <- car::vif(M4) ## 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4



##M3: dropping Count FEMA SFHA
names(DNZ15_CSC)
M3 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.6

##testing for multicollinearity
M3_Vif <- car::vif(M3) ## 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M2: Dropping all hypothesis vase
names(DNZ15_CSC)
M2 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_CSC,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.6

##testing for multicollinearity
M2_Vif <- car::vif(M2) ## 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2



#Model All
V1 <- stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES", "YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES", "YES", "YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R8, R7, R6, R5, R4, R3, R2)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_F2_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'ZCTA_shore' Sample (n=1324 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES","YES"),
                                 c("Pseudo $R2$",  R8, R7, R6, R5, R4,R3, R2)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```



## Logistic Regression Models: "ZCTA Shoreline" Sample (H series)

##### Model Series H.0: Single variable model with FE for all explanatory vars:
```{r include= FALSE}

##M0: FE 
names(DNZ15_ZCTA_shore)
M0 <- glm(felev~
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M0)

##testing for overdispersion
deviance(M0)/df.residual(M0)

##testing for multicollinearity
M0_Vif <- car::vif(M0) 
M0_Vif

#exponentiating coeff for ofyDeclareds ratios
M0Exp <- M0
M0Exp$coefficients <- exp(M0Exp$coefficients)
M0Exp

# pseudo R-squared
R0 <- (1-(M0$deviance)/(M0$null.deviance))
R0 <- round(R0,2)
R0


##M1: MHV
names(DNZ15_ZCTA_shore)
M1 <- glm(felev~
            MHVadj_W_100k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1)

##testing for multicollinearity
M1_Vif <- car::vif(M1) 
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1

##M2: fWhite
names(DNZ15_ZCTA_shore)
M2 <- glm(felev~
            fWhite +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2)

##testing for multicollinearity
M2_Vif <- car::vif(M2) 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2

##M3: RepRate
names(DNZ15_ZCTA_shore)
M3 <- glm(felev~
            RepRate +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3)

##testing for multicollinearity
M3_Vif <- car::vif(M3) 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3


##M4: ZCTA_shore NA



##M5: FEMA SFHA
names(DNZ15_ZCTA_shore)
M5 <- glm(felev~
            count_fema_sfha_W_1k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5)

##testing for multicollinearity
M5_Vif <- car::vif(M5) 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5

##M6: NFIP ICC
names(DNZ15_ZCTA_shore)
M6 <- glm(felev~
            NFIP_ICCadj_YOLZ_W_1M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6)

##testing for multicollinearity
M6_Vif <- car::vif(M6) 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

##M7: NFIP IHP
names(DNZ15_ZCTA_shore)
M7 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7)

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: Hurricane
names(DNZ15_ZCTA_shore)
M8 <- glm(felev~
            Hurricane +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8)

##testing for multicollinearity
M8_Vif <- car::vif(M8) 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

##M9: Tot Pop
names(DNZ15_ZCTA_shore)
M9 <- glm(felev~
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M9)

##testing for overdispersion
deviance(M9)/df.residual(M9)

##testing for multicollinearity
M9_Vif <- car::vif(M9) 
M9_Vif

#exponentiating coeff for ofyDeclareds ratios
M9Exp <- M9
M9Exp$coefficients <- exp(M9Exp$coefficients)
M9Exp

# pseudo R-squared
R9 <- (1-(M9$deviance)/(M9$null.deviance))
R9 <- round(R9,2)
R9


##M10: fOwnOcc
names(DNZ15_ZCTA_shore)
M10 <- glm(felev~
            fOwnOcc +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M10)

##testing for overdispersion
deviance(M10)/df.residual(M10)

##testing for multicollinearity
M10_Vif <- car::vif(M10) 
M10_Vif

#exponentiating coeff for ofyDeclareds ratios
M10Exp <- M10
M10Exp$coefficients <- exp(M10Exp$coefficients)
M10Exp

# pseudo R-squared
R10 <- (1-(M10$deviance)/(M10$null.deviance))
R10 <- round(R10,2)
R10


#Model All
V1 <- stargazer(M0,M1,M2,M3,M5,M6,M7,M8,M9,M10,
                type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3, R5, R6, R7, R8, R9, R10)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_H0_SVM.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M0, M1, M2, M3, M5, M6, M7, M8, M9, M10,
                type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'Shoreline ZCTA' Sample (n=843 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R3, R5, R6, R7, R8, R9, R10)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "NFIP ICC Claims 1M (W) by ZCTA-YOL",
                                     "IHP Damage Estimates 10M (W)",
                                     "Hurricane",
                                     "Total Population 10k (W)",
                                     "Fraction of Owner Occ. HUs"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series F.1 (Testing 5 hypotheses against baseline)
```{r include= FALSE}
##M1: Baseline:  Damages, TotPopW_10k, + State FE 
names(DNZ15_ZCTA_shore)
M1 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1) #0.53

##testing for multicollinearity
M1_Vif <- car::vif(M1) #good
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1


#M2: MHV + Baseline
names(DNZ15_ZCTA_shore)
M2 <- glm(felev~
            MHVadj_W_100k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k + 
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.81

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)

#pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2


#M3: fWhite + Baseline
names(DNZ15_ZCTA_shore)
M3 <- glm(felev~
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.87

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)

#pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

#M4: Both: MHV + fWhite + Baseline
M4 <- glm(felev~
            MHVadj_W_100k+ 
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.81

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: ZCTA_shore + Baseline. NA

##M6: RepRate + Baseline
names(DNZ15_ZCTA_shore)
M6 <- glm(felev~
            RepRate +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.87

##testing for multicollinearity

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

#M7: SFHA + baseline
M7 <- glm(felev~
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.81

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: All + Baseline (w year FEs)
names(DNZ15_ZCTA_shore)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            #ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

#Model All
V1 <- stargazer(M1,M2,M3,M4,M6,M7,M8, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES", "YES", "YES","YES","YES", "YES", "YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES", "YES", "YES"),
                                 c("Pseudo $R2$", R1, R2, R3, R4, R6,R7, R8)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_H1_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M1, M2, M3, M4,  M6,M7, M8, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'Shoreline ZCTA' Sample (n=843 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES", "YES", "YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES", "YES", "YES"),
                                 c("Pseudo $R2$",  R1, R2, R3, R4, R6, R7, R8)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series F.2 (Starting with best model from above (M8) and dropping vars)
```{r include= FALSE}
##M8: All + Baseline (w year FEs)
names(DNZ15_ZCTA_shore)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            #ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8


##M7: dropping MHV
names(DNZ15_ZCTA_shore)
M7 <- glm(felev~
            fWhite +
            RepRate +
            #ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.6

##testing for multicollinearity
M7_Vif <- car::vif(M7) ## 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7


## Dropping fWhite
M6 <- glm(felev~
            MHVadj_W_100k +
            RepRate +
            #ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.6

##testing for multicollinearity
M6_Vif <- car::vif(M6) ## 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


##M5: dropping RepRate
names(DNZ15_ZCTA_shore)
M5 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            #ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.6

##testing for multicollinearity
M5_Vif <- car::vif(M5) ## 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5

##M4: dropping ZCTA_shore. NA


##M3: dropping Count FEMA SFHA
names(DNZ15_ZCTA_shore)
M3 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            #ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.6

##testing for multicollinearity
M3_Vif <- car::vif(M3) ## 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M2: Dropping all hypothesis vase
names(DNZ15_ZCTA_shore)
M2 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.6

##testing for multicollinearity
M2_Vif <- car::vif(M2) ## 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2



#Model All
V1 <- stargazer(M8,M7,M6,M5,M3,M2, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","YES", "YES","YES","YES","YES","YES"),
                                 c("Year FE", "YES","YES","YES","YES","YES","YES"),
                                 c("Pseudo $R2$", R8, R7, R6, R5,  R3, R2)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_H2_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M8,M7,M6,M5,M3,M2, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: 'Shoreline ZCTA' Sample (n=843 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES"),
                                 c("Year FE",  "YES", "YES", "YES", "YES","YES","YES"),
                                 c("Pseudo $R2$",  R8, R7, R6, R5,R3, R2)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```



## Logistic Regression Models: "Sandy" Sample (G series)

##### Model Series G.0: Single variable model with FE for all explanatory vars:
```{r include= FALSE}


##M1: MHV
names(DNZ15_Sandy)
M1 <- glm(felev~
            MHVadj_W_100k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
#deviance(M1)/df.residual(M1)

##testing for multicollinearity
#M1_Vif <- car::vif(M1) 
#M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1

##M2: fWhite
names(DNZ15_Sandy)
M2 <- glm(felev~
            fWhite,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2)

##testing for multicollinearity
#M2_Vif <- car::vif(M2) 
#M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2

##M3: RepRate
names(DNZ15_Sandy)
M3 <- glm(felev~
            RepRate,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3)

##testing for multicollinearity
#M3_Vif <- car::vif(M3) 
#M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M4: ZCTA_shore
names(DNZ15_Sandy)
M4 <- glm(felev~
            ZCTA_shore,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4)

##testing for multicollinearity
#M4_Vif <- car::vif(M4) 
#M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: FEMA SFHA
names(DNZ15_Sandy)
M5 <- glm(felev~
            count_fema_sfha_W_1k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5)

##testing for multicollinearity
#M5_Vif <- car::vif(M5) 
#M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5

##M6: NFIP ICC
names(DNZ15_Sandy)
M6 <- glm(felev~
            NFIP_ICCadj_YOLZ_W_1M,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6)

##testing for multicollinearity
#M6_Vif <- car::vif(M6) 
#M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

##M7: NFIP IHP
names(DNZ15_Sandy)
M7 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7)

##testing for multicollinearity
#M7_Vif <- car::vif(M7) 
#M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

#M8: Hurricane: NA

##M9: Tot Pop
names(DNZ15_Sandy)
M9 <- glm(felev~
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M9)

##testing for overdispersion
deviance(M9)/df.residual(M9)

##testing for multicollinearity
#M9_Vif <- car::vif(M9) 
#M9_Vif

#exponentiating coeff for ofyDeclareds ratios
M9Exp <- M9
M9Exp$coefficients <- exp(M9Exp$coefficients)
M9Exp

# pseudo R-squared
R9 <- (1-(M9$deviance)/(M9$null.deviance))
R9 <- round(R9,2)
R9


##M10: fOwnOcc
names(DNZ15_Sandy)
M10 <- glm(felev~
            fOwnOcc,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M10)

##testing for overdispersion
deviance(M10)/df.residual(M10)

##testing for multicollinearity
#M10_Vif <- car::vif(M10) 
#M10_Vif

#exponentiating coeff for ofyDeclareds ratios
M10Exp <- M10
M10Exp$coefficients <- exp(M10Exp$coefficients)
M10Exp

# pseudo R-squared
R10 <- (1-(M10$deviance)/(M10$null.deviance))
R10 <- round(R10,2)
R10


#Model All
V1 <- stargazer(M1,M2,M3,M4,M5,M6,M7,M9,M10,
                type="html",
                omit=c("StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","No","No","No","No","No","No","No","No","No","No"),
                                 c("Pseudo $R2$", R1, R2, R3, R4, R5, R6, R7, R9, R10)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_G0_SVM.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M1, M2, M3, M4, M5, M6, M7, M9, M10,
                type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: Full Sample (n=4334 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","No","No","No","No","No","No","No","No","No","No"),
                                 c("Pseudo $R2$",R1, R2, R3, R4, R5, R6, R7,  R9, R10)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "NFIP ICC Claims 1M (W) by ZCTA-YOL",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)",
                                     "Fraction of Owner Occ. HUs"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series G.1 (Testing 5 hypotheses against baseline)
```{r include= FALSE}
##M1: Baseline:  Damages, TotPopW_10k, + State FE 
names(DNZ15_Sandy)
M1 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1) #0.53

##testing for multicollinearity
M1_Vif <- car::vif(M1) #good
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1


#M2: MHV + Baseline
names(DNZ15_Sandy)
M2 <- glm(felev~
            MHVadj_W_100k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) 

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)

#pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2


#M3: fWhite + Baseline
names(DNZ15_Sandy)
M3 <- glm(felev~
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.87

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)

#pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

#M4: Both: MHV + fWhite + Baseline
M4 <- glm(felev~
            MHVadj_W_100k+ 
            fWhite +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.81

##testing for multicollinearity
M4_Vif <- car::vif(M4) 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M5: RepRate + Baseline
names(DNZ15_Sandy)
M5 <- glm(felev~
            RepRate +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.87

##testing for multicollinearity

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M6: ZCTA_shore + Baseline
names(DNZ15_Sandy)
M6 <- glm(felev~
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) 

##testing for multicollinearity


#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


#M7: SFHA + baseline
M7 <- glm(felev~
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.81

##testing for multicollinearity
M7_Vif <- car::vif(M7) 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7

##M8: All + Baseline (w year FEs)
names(DNZ15_Sandy)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8

#Model All
V1 <- stargazer(M1,M2,M3,M4,M5,M6,M7,M8, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","No","No","No","No","No","No","No","No"),
                                 c("Pseudo $R2$", R1, R2, R3, R4, R5, R6, R7, R8)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_G1_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer( M1, M2, M3, M4, M5, M6, M7, M8, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: Full Sample (n=4334 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","No","No","No","No","No","No","No","No"),
                                 c("Pseudo $R2$",  R1, R2, R3, R4, R5, R6, R7, R8)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


##### Model Series G.2 (Starting with best model from above (M8) and dropping vars)
```{r include= FALSE}
##M8: All + Baseline (w year FEs)
names(DNZ15_Sandy)
M8 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M8)

##testing for overdispersion
deviance(M8)/df.residual(M8) #0.6

##testing for multicollinearity
M8_Vif <- car::vif(M8) ## 
M8_Vif

#exponentiating coeff for ofyDeclareds ratios
M8Exp <- M8
M8Exp$coefficients <- exp(M8Exp$coefficients)
M8Exp

# pseudo R-squared
R8 <- (1-(M8$deviance)/(M8$null.deviance))
R8 <- round(R8,2)
R8


##M7: dropping MHV
names(DNZ15_Sandy)
M7 <- glm(felev~
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.6

##testing for multicollinearity
M7_Vif <- car::vif(M7) ## 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7


## Dropping fWhite
M6 <- glm(felev~
            MHVadj_W_100k +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.6

##testing for multicollinearity
M6_Vif <- car::vif(M6) ## 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6


##M5: dropping RepRate
names(DNZ15_Sandy)
M5 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.6

##testing for multicollinearity
M5_Vif <- car::vif(M5) ## 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M4: dropping ZCTA_shore
names(DNZ15_Sandy)
M4 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.6

##testing for multicollinearity
M4_Vif <- car::vif(M4) ## 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4

##M3: dropping Count FEMA SFHA
names(DNZ15_Sandy)
M3 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M3)

##testing for overdispersion
deviance(M3)/df.residual(M3) #0.6

##testing for multicollinearity
M3_Vif <- car::vif(M3) ## 
M3_Vif

#exponentiating coeff for ofyDeclareds ratios
M3Exp <- M3
M3Exp$coefficients <- exp(M3Exp$coefficients)
M3Exp

# pseudo R-squared
R3 <- (1-(M3$deviance)/(M3$null.deviance))
R3 <- round(R3,2)
R3

##M2: Dropping all hypothesis vase
names(DNZ15_Sandy)
M2 <- glm(felev~
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k,
          data=DNZ15_Sandy,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.6

##testing for multicollinearity
M2_Vif <- car::vif(M2) ## 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2



#Model All
V1 <- stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE","No", "No", "No", "No","No","No","No"),
                                 c("Pseudo $R2$", R8, R7, R6, R5, R4, R3, R2)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_G2_IHP.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M8,M7,M6,M5,M4,M3,M2, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison: Full Sample (n=4334 DNZs)", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("State FE",  "YES", "YES", "YES", "YES","YES","YES","YES"),
                                 c("Pseudo $R2$",  R8, R7, R6, R5, R4, R3, R2)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Estimates 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```





## Logistic Regression Models: six samples (X Series)
##### Model Series X.1 (All 6 Samples, All Variables)
```{r include= FALSE}

##M1: All: Data = DNZ15
names(DNZ15)
M1 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1) #0.45

##testing for multicollinearity
M1_Vif <- car::vif(M1) ## 
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1


##M2: Data = DNZ15_lessMix
names(DNZ15)
M2 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.44

##testing for multicollinearity
M2_Vif <- car::vif(M2) ## 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2



##M4: Data = DNZ15_After1993
names(DNZ15)
M4 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993, family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.47

##testing for multicollinearity
M4_Vif <- car::vif(M4) ## 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4


##M5: Data = DNZ15_WOSandy
M5 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy, family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.45

##testing for multicollinearity
M5_Vif <- car::vif(M5) ## 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M6: Data = DNZ15_WOKatrina
M6 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina, family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.45

##testing for multicollinearity
M6_Vif <- car::vif(M6) ## 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

##M7: Data = DNZ15_ZCTA_shore
M7 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore, family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.45

##testing for multicollinearity
M7_Vif <- car::vif(M7) ## 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7



#Model All
V1 <- stargazer(M1,M2,M4,M5,M6,M7, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("Sample", "Full", "Less Mix",  "After 1993", "w/o Sandy", "w/o Katrina", "Shore ZCTA"),
                                 c("State FE","YES", "YES", "YES", "YES","YES","YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES"),
                                 c("Pseudo $R2$", R1, R2, R4, R5, R6, R7)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_X1_IHP_6samples.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M1,M2,M4,M5,M6,M7, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("Sample", "Full", "Less Mix",  "After 1993","w/o Sandy", "w/o Katrina", "Shore ZCTA"),
                                 c("State FE","YES", "YES", "YES", "YES","YES","YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES"),
                                 c("Pseudo $R2$", R1, R2, R4, R5, R6, R7)),
                covariate.labels = c("Median Home Value $100k (W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Damage Est. 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```

##### Model Series X.2 (Same as X.1, except dropping fWhite and RepRate)
```{r include= FALSE}

##M1: All: Data = DNZ15
names(DNZ15)
M1 <- glm(felev~
            MHVadj_W_100k +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1) #0.45

##testing for multicollinearity
M1_Vif <- car::vif(M1) ## 
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1


##M2: Data = DNZ15_lessMix
names(DNZ15)
M2 <- glm(felev~
            MHVadj_W_100k +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.44

##testing for multicollinearity
M2_Vif <- car::vif(M2) ## 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2



##M4: Data = DNZ15_After1993
names(DNZ15)
M4 <- glm(felev~
            MHVadj_W_100k +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993, family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.47

##testing for multicollinearity
M4_Vif <- car::vif(M4) ## 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4


##M5: Data = DNZ15_WOSandy
M5 <- glm(felev~
            MHVadj_W_100k +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy, family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.45

##testing for multicollinearity
M5_Vif <- car::vif(M5) ## 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M6: Data = DNZ15_WOKatrina
M6 <- glm(felev~
            MHVadj_W_100k +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina, family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.45

##testing for multicollinearity
M6_Vif <- car::vif(M6) ## 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

##M7: Data = DNZ15_ZCTA_shore
M7 <- glm(felev~
            MHVadj_W_100k +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore, family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.45

##testing for multicollinearity
M7_Vif <- car::vif(M7) ## 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7



#Model All
V1 <- stargazer(M1,M2,M4,M5,M6,M7, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("Sample", "Full", "Less Mix",  "After 1993", "w/o Sandy", "w/o Katrina", "Shore ZCTA"),
                                 c("State FE","YES", "YES", "YES", "YES","YES","YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES"),
                                 c("Pseudo $R2$", R1, R2, R4, R5, R6, R7)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_X2_IHP_6samples.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M1,M2,M4,M5,M6,M7, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("Sample", "Full", "Less Mix",  "After 1993","w/o Sandy", "w/o Katrina", "Shore ZCTA"),
                                 c("State FE","YES", "YES","YES","YES", "YES","YES"),
                                 c("Year FE", "YES", "YES","YES","YES", "YES","YES"),
                                 c("Pseudo $R2$", R1, R2, R4, R5, R6, R7)),
                covariate.labels = c("MHV ($100k W)",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Dmg Est. 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```

##### Model Series X.2b (Dropping fWhite & RepRate EXCEPT FOR FIRST FULL MODEL)
```{r include= FALSE}


##M0: All: Data = DNZ15
names(DNZ15)
M0 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M0)

##testing for overdispersion
deviance(M0)/df.residual(M0) #0.45

##testing for multicollinearity
M0_Vif <- car::vif(M0) ## 
M0_Vif

#exponentiating coeff for ofyDeclareds ratios
M0Exp <- M0
M0Exp$coefficients <- exp(M0Exp$coefficients)
M0Exp

# pseudo R-squared
R0 <- (1-(M0$deviance)/(M0$null.deviance))
R0 <- round(R0,2)
R0



#Model All
V1 <- stargazer(M0, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("Sample", "Full","Shore ZCTA"),
                                 c("State FE","YES","YES"),
                                 c("Year FE", "YES","YES"),
                                 c("Pseudo $R2$", R0)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_X2b_IHP_6samples.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M0,M1,M2,M4,M5,M6,M7, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("Sample", "Full", "Full", "Less Mix",  "After 1993","w/o Sandy", "w/o Katrina", "Shore ZCTA"),
                                 c("State FE","YES","YES", "YES", "YES", "YES","YES","YES"),
                                 c("Year FE", "YES","YES", "YES", "YES", "YES","YES","YES"),
                                 c("Pseudo $R2$", R0, R1, R2, R4, R5, R6, R7)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Dmg Est. 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```


## Logistic Regression Models: six samples (X Series)
##### Model Series X.3 (AIC minimizing models by sample)
```{r include= FALSE}

##M1: All: Data = DNZ15
names(DNZ15)
M1 <- glm(felev~
            MHVadj_W_100k +
            #fWhite +
            #RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1) #0.45

##testing for multicollinearity
M1_Vif <- car::vif(M1) ## 
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1


##M2: Data = DNZ15_lessMix
names(DNZ15)
M2 <- glm(felev~
            MHVadj_W_100k +
            #fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.44

##testing for multicollinearity
M2_Vif <- car::vif(M2) ## 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2



##M4: Data = DNZ15_After1993
names(DNZ15)
M4 <- glm(felev~
            MHVadj_W_100k +
            #fWhite +
            #RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993, family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.47

##testing for multicollinearity
M4_Vif <- car::vif(M4) ## 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4


##M5: Data = DNZ15_WOSandy
M5 <- glm(felev~
            MHVadj_W_100k +
            #fWhite +
            #RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy, family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.45

##testing for multicollinearity
M5_Vif <- car::vif(M5) ## 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M6: Data = DNZ15_WOKatrina
M6 <- glm(felev~
            MHVadj_W_100k +
            #fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina, family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.45

##testing for multicollinearity
M6_Vif <- car::vif(M6) ## 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

##M7: Data = DNZ15_ZCTA_shore
M7 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            count_fema_sfha_W_1k +
            IHP_fldDamAmountAdjDNZ_W_10M +
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore, family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.45

##testing for multicollinearity
M7_Vif <- car::vif(M7) ## 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7



#Model All
V1 <- stargazer(M1,M2,M4,M5,M6,M7, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("Sample", "Full", "Less Mix",  "After 1993", "w/o Sandy", "w/o Katrina", "Shore ZCTA"),
                                 c("State FE","YES", "YES", "YES", "YES","YES","YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES"),
                                 c("Pseudo $R2$", R1, R2, R4, R5, R6, R7)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_X3_AIC_6samples.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M1,M2,M4,M5,M6,M7, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("Sample", "Full", "Less Mix",  "After 1993","w/o Sandy", "w/o Katrina", "Shore ZCTA"),
                                 c("State FE","YES", "YES", "YES", "YES","YES","YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES"),
                                 c("Pseudo $R2$", R1, R2, R4, R5, R6, R7)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "IHP Dmg Est. 10M (W)",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```



##### Model Series X.4 (Sensitivity: Subbing ICC for IHP)
```{r include= FALSE}

##M1: All: Data = DNZ15
names(DNZ15)
M1 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            NFIP_ICCadj_YOLZ_W_1M+
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15,family=binomial(link = "logit"))
summary(M1)

##testing for overdispersion
deviance(M1)/df.residual(M1) #0.45

##testing for multicollinearity
M1_Vif <- car::vif(M1) ## 
M1_Vif

#exponentiating coeff for ofyDeclareds ratios
M1Exp <- M1
M1Exp$coefficients <- exp(M1Exp$coefficients)
M1Exp

# pseudo R-squared
R1 <- (1-(M1$deviance)/(M1$null.deviance))
R1 <- round(R1,2)
R1


##M2: Data = DNZ15_lessMix
names(DNZ15)
M2 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            NFIP_ICCadj_YOLZ_W_1M+
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_lessMix,family=binomial(link = "logit"))
summary(M2)

##testing for overdispersion
deviance(M2)/df.residual(M2) #0.44

##testing for multicollinearity
M2_Vif <- car::vif(M2) ## 
M2_Vif

#exponentiating coeff for ofyDeclareds ratios
M2Exp <- M2
M2Exp$coefficients <- exp(M2Exp$coefficients)
M2Exp

# pseudo R-squared
R2 <- (1-(M2$deviance)/(M2$null.deviance))
R2 <- round(R2,2)
R2



##M4: Data = DNZ15_After1993
names(DNZ15)
M4 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            NFIP_ICCadj_YOLZ_W_1M+
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_After1993, family=binomial(link = "logit"))
summary(M4)

##testing for overdispersion
deviance(M4)/df.residual(M4) #0.47

##testing for multicollinearity
M4_Vif <- car::vif(M4) ## 
M4_Vif

#exponentiating coeff for ofyDeclareds ratios
M4Exp <- M4
M4Exp$coefficients <- exp(M4Exp$coefficients)
M4Exp

# pseudo R-squared
R4 <- (1-(M4$deviance)/(M4$null.deviance))
R4 <- round(R4,2)
R4


##M5: Data = DNZ15_WOSandy
M5 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            NFIP_ICCadj_YOLZ_W_1M+
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOSandy, family=binomial(link = "logit"))
summary(M5)

##testing for overdispersion
deviance(M5)/df.residual(M5) #0.45

##testing for multicollinearity
M5_Vif <- car::vif(M5) ## 
M5_Vif

#exponentiating coeff for ofyDeclareds ratios
M5Exp <- M5
M5Exp$coefficients <- exp(M5Exp$coefficients)
M5Exp

# pseudo R-squared
R5 <- (1-(M5$deviance)/(M5$null.deviance))
R5 <- round(R5,2)
R5


##M6: Data = DNZ15_WOKatrina
M6 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            ZCTA_shore +
            count_fema_sfha_W_1k +
            NFIP_ICCadj_YOLZ_W_1M+
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_WOKatrina, family=binomial(link = "logit"))
summary(M6)

##testing for overdispersion
deviance(M6)/df.residual(M6) #0.45

##testing for multicollinearity
M6_Vif <- car::vif(M6) ## 
M6_Vif

#exponentiating coeff for ofyDeclareds ratios
M6Exp <- M6
M6Exp$coefficients <- exp(M6Exp$coefficients)
M6Exp

# pseudo R-squared
R6 <- (1-(M6$deviance)/(M6$null.deviance))
R6 <- round(R6,2)
R6

##M7: Data = DNZ15_ZCTA_shore
M7 <- glm(felev~
            MHVadj_W_100k +
            fWhite +
            RepRate +
            count_fema_sfha_W_1k +
            NFIP_ICCadj_YOLZ_W_1M+
            TotPop_W_10k +
            factor(StateNumLG) +
            factor(fyDeclared),
          data=DNZ15_ZCTA_shore, family=binomial(link = "logit"))
summary(M7)

##testing for overdispersion
deviance(M7)/df.residual(M7) #0.45

##testing for multicollinearity
M7_Vif <- car::vif(M7) ## 
M7_Vif

#exponentiating coeff for ofyDeclareds ratios
M7Exp <- M7
M7Exp$coefficients <- exp(M7Exp$coefficients)
M7Exp

# pseudo R-squared
R7 <- (1-(M7$deviance)/(M7$null.deviance))
R7 <- round(R7,2)
R7



#Model All
V1 <- stargazer(M1,M2,M4,M5,M6,M7, type="html",
                omit=c("StateNumLG","fyDeclared"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("Sample", "Full", "Less Mix",  "After 1993", "w/o Sandy", "w/o Katrina", "Shore ZCTA"),
                                 c("State FE","YES", "YES", "YES", "YES","YES","YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES"),
                                 c("Pseudo $R2$", R1, R2, R4, R5, R6, R7)),
                digits=2,
                column.sep.width = "10pt",
                #order=order,
                single.row = FALSE,
                align=TRUE,
                out="G:/My Drive/Academic/Research/Results/NationalProject/HMA_V3/Tables/DNZLevel/DNZ15/FullSample/felev/V23/DNZ_V1_felev_X4_ICC_6samples.htm")
```

```{r echo=FALSE, results= 'asis'}
stargazer(M1,M2,M4,M5,M6,M7, type="html",
                omit=c("fyDeclared", "StateNumLG"),
                apply.coef=exp,
                apply.ci=exp,
                t.auto=F,
                p.auto=F,
                title="Logit Model Comparison", 
                dep.var.labels = c("OfyDeclareds Ratio of felev"),
                afyDeclared.lines = list(c("Sample", "Full", "Less Mix",  "After 1993","w/o Sandy", "w/o Katrina", "Shore ZCTA"),
                                 c("State FE","YES", "YES", "YES", "YES","YES","YES"),
                                 c("Year FE", "YES", "YES", "YES", "YES","YES","YES"),
                                 c("Pseudo $R2$", R1, R2, R4, R5, R6, R7)),
                covariate.labels = c("MHV ($100k W)",
                                     "Fraction White",
                                     "County Republican Vote Rate",
                                     "Shoreline ZCTA" ,
                                     "Count of HUs in FEMA SFHA 1k (W)",
                                     "ICC Claims 1M (W) by ZCTA-YOL",
                                     "Total Population 10k (W)"),
                digits=2,
                column.sep.width = "10pt",
                single.row = FALSE,
                align=TRUE)
```
