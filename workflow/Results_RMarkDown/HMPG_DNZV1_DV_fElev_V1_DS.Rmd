

---
title: "Supplementary Information: Descriptive Statistics"
author: "Laura Geronimo"
output:
  html_document:
    toc: true
    toc_depth: 6
    theme: united

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r include=FALSE}
getwd()

##Libraries
library(dplyr)
library(stringr)
library(Hmisc)
library(tidycensus)
library(corrplot)
library(dplyr)
library(data.table)
library(ggplot2)
library(pastecs)
library(car)
library(gvlma)
library(qcc)
library(stargazer)
library(viridis)

library(forcats)
library(boot)
library(lmtest)
library(sandwich)
library(ggpubr)

options (scipen=999)

#importing data
DNZV1 <- read.csv('C:/Users/lgero/Box/Research/FEMA_project/Data/Edited/HMA/DNZLevel/DNZ_V1/DNZ_V1.csv')

names(DNZV1)
DNZV1 <- DNZV1[,c(-1)]

#creating subsets
DNZV1_lessMix <- subset(DNZV1, felev==0 | felev==1)
DNZV1_After1993 <- subset(DNZV1, fyDeclared >1993)
DNZV1_ZCTA_shore <- subset(DNZV1, ZCTA_shore==1) 

DNZV1_Katrina <- subset(DNZV1, declarationTitle %like% "katrina") 
DNZV1_Sandy <- subset(DNZV1, declarationTitle %like% "sandy") 
DNZV1_Mix <- subset(DNZV1, felev>0 & felev<1)

```


## Descriptive Statistics: 
### Full Sample 
```{r include=FALSE}
#Full Set: descriptive statistics
names(DNZV1)
range(DNZV1$DD)
table(DNZV1$incidentTypeB)
sum(DNZV1$TotalProps)
sum(DNZV1$Elev)
sum(DNZV1$Acqui)
DS_all <- DNZV1[,c("felev",
                   "Elev", "Acqui",
                   "TotPop_W_10k",
                   "PopDense_W_1k", #NEW
                   "fWhite",
                   "fBlack",
                   "fHisp",
                   "MHIadj_W_10k",
                   "MHVadj_W_100k",
                   "TotHU_W_10k",  #NEW
                   "TotOccHU_W_10k", 
                   "RepRate",
                   "mrp_ideology", #NEW
                   "fOwnOcc",
                   "fRentOcc", #NEW
                   "fS2ndHome",  #NEW
                   "TaxBaseEst_1B_W",
                   "ZCTA_shore", 
                   "count_fema_sfha_W_1k",
                   "count_fs_risk_500_year00_W_1k", #NEW
                   "NFIP_ICCadj_YOLZ_W_1M",
                   "NFIP_AllClaimsAdj_YOLZ_W_10M", #NEW
                   "IHP_fldDamAmountAdjDNZ_W_10M",
                   "Hurricane",
                   "fyDeclared")]

names(DS_all)
str(DS_all)
describe(DS_all)

# Ensure all relevant columns are numeric
#DS_all <- data.frame(lapply(DS_all, function(x) as.numeric(as.character(x))))

# Compute descriptive statistics
DS_all2 <- stat.desc(DS_all, basic=TRUE, options(scipen=100))



DS_all3<-DS_all2[c("min",
                   "max",
                   "range",
                   "median",
                   "mean",
                   "std.dev"),]

new_names <- c(
  "felev" = "felev",
  "Elev" = "Total Elevations",
  "Acqui" = "Total Acquisitions",
  "TotPop_W_10k" = "Total Pop. 10k (W)",
  "PopDense_W_1k" = "Pop. Dense 1k (W)",
  "fWhite" = "Fraction White",
  "fBlack" = "Fraction Black",
  "fHisp" = "Fraction Hispanic",
  "RepRate" = "County Republican Vote Rate",
  "mrp_ideology" ="mrp_ideology",
  "MHIadj_W_10k" = "Median HH Income 10k (W)",
  "MHVadj_W_100k" = "Median Home Value 100k (W)",
  "TotHU_W_10k" = "Total HU 10k (W)",
  "TotOccHU_W_10k" = "Total Occ. HU 10k (W)",
  "fOwnOcc" = "Fraction HUs Owner Occ.",
  "fRentOcc" = "Fraction HUs Renter Occ.",
  "fS2ndHome" = "Fraction HUs 2nd Home",
  "TaxBaseEst_1B_W" = "Est. Tax Base 1B (W)",
  "ZCTA_shore" = "Shoreline ZCTA",
  "count_fema_sfha_W_1k" = "Count of HU in FEMA SFHA 1k (W)",
  "count_fs_risk_500_year00_W_1k" = "FS Count of HU in 500yr risk 1k (W)",
  "NFIP_ICCadj_YOLZ_W_1M" = "NFIP ICC Est. $1M (W)",
  "NFIP_AllClaimsAdj_YOLZ_W_10M" = "NFIP All Claims Est. $10M (W)",
  "IHP_fldDamAmountAdjDNZ_W_10M" = "IHP Damage Est. $10M (W)",
  "Hurricane"="Hurricane",
  "fyDeclared"= "fyDeclared"
)

# Rename columns
names(DS_all3) <- new_names[names(DS_all3)]

names(DS_all3)
```

```{r echo=FALSE}
knitr::kable(DS_all3,
            caption="Descriptive Statistics")

```

### Scatterplot Matrix: Full Sample
```{r include=FALSE}
names(DS_all3)
DNZV1_scatter <- DS_all 

```

```{r echo=FALSE, message=FALSE, warning=FALSE}

#scatterplotMatrix(DNZV1_scatter, spread=FALSE, smoother.args=list(lty=2), main="Scatter Plot Matrix")
names(DS_all)
plot(DS_all$felev, DS_all$TotPop_W_10k)
plot(DS_all$felev, DS_all$PopDense_W_1k)
plot(DS_all$felev, DS_all$fWhite)
plot(DS_all$felev, DS_all$fBlack)
plot(DS_all$felev, DS_all$fHisp)
plot(DS_all$felev, DS_all$MHIadj_W_10k)
plot(DS_all$felev, DS_all$MHVadj_W_100k)
plot(DS_all$felev, DS_all$TotHU_W_10k)
plot(DS_all$felev, DS_all$TotOccHU_W_10k)
plot(DS_all$felev, DS_all$RepRate)
plot(DS_all$felev, DS_all$mrp_ideology)
plot(DS_all$felev, DS_all$fOwnOcc)
plot(DS_all$felev, DS_all$fRentOcc)
plot(DS_all$felev, DS_all$fS2ndHome)
plot(DS_all$felev, DS_all$TaxBaseEst_1B_W)
plot(DS_all$felev, DS_all$ZCTA_shore)
plot(DS_all$felev, DS_all$count_fema_sfha_W_1k)
plot(DS_all$felev, DS_all$count_fs_risk_500_year00_W_1k)
plot(DS_all$felev, DS_all$NFIP_ICCadj_YOLZ_W_1M)
plot(DS_all$felev, DS_all$NFIP_AllClaimsAdj_YOLZ_W_10M)
plot(DS_all$felev, DS_all$IHP_fldDamAmountAdjDNZ_W_10M)
plot(DS_all$felev, DS_all$Hurricane)


```

### Descriptive Statistics: Subsets of interest

#### Descriptive Statistics: DNZs with only acquisitions, no elevations (f_elev < 0.99) (n=4216 DNZs)
```{r include=FALSE}

DS_4 <- subset(DS_all, felev < 0.01)

DS_4b  <- stat.desc(DS_4 , basic=TRUE, options(scipen=100))

DS_4c <- DS_4b[c("min",
                   "max",
                   "range",
                   "median",
                   "mean",
                   "std.dev"),]

names(DS_4c) <- new_names[names(DS_4c)]
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(DS_4c,
            caption="Descriptive Statistics")

```

#### Descriptive Statistics: DNZs with only elevations and no acquisitions (f_elev >= 0.99) (n=1062 DNZs)
```{r include=FALSE}

DS_5 <- subset(DS_all, felev >= 0.99)

DS_5b  <- stat.desc(DS_5 , basic=TRUE, 
                     options(scipen=100))

DS_5c <- DS_5b[c("min",
                   "max",
                   "range",
                   "median",
                   "mean",
                   "std.dev"),]

names(DS_5c) <- new_names[names(DS_5c)]
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(DS_5c,
            caption="Descriptive Statistics")

```


#### Descriptive Statistics: DNZs with at least 1 elevation (Elev > 0) (n=1445 DNZs)
```{r include=FALSE}

DS_6 <- subset(DS_all, Elev > 0) #1445

DS_6b  <- stat.desc(DS_6 , basic=TRUE, 
                     options(scipen=100))

DS_6c <- DS_6b[c("min",
                   "max",
                   "range",
                   "median",
                   "mean",
                   "std.dev"),]

names(DS_6c) <- new_names[names(DS_6c)]

```

```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(DS_6c,
            caption="Descriptive Statistics")

```

#### Descriptive Statistics: DNZs with at least 1 Acquisition (Acqui > 0) (n=4596 DNZs)
```{r include=FALSE}

DS_7 <- subset(DS_all, Acqui > 0) 

DS_7b  <- stat.desc(DS_7 , basic=TRUE, 
                     options(scipen=100))

DS_7c <- DS_7b[c("min",
                   "max",
                   "range",
                   "median",
                   "mean",
                   "std.dev"),]

names(DS_7c) <- new_names[names(DS_7c)]

```

```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(DS_7c,
            caption="Descriptive Statistics")

```


#### Descriptive Statistics: DNZs with a 'mix' of elevations and acquisitions (0.99 > f_elev > 0.01) (n=380 DNZs) 
```{r include=FALSE}

DS_8 <- subset(DS_all, felev > 0.01 & 
                        felev < 0.99)

DS_8b  <- stat.desc(DS_8 , basic=TRUE, 
                     options(scipen=100))

DS_8c <- DS_8b[c("min",
                   "max",
                   "range",
                   "median",
                   "mean",
                   "std.dev"),]

names(DS_8c)<- new_names[names(DS_8c)]
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(DS_8c,
            caption="Descriptive Statistics")

```

#### Descriptive Statistics: 'Less Mix' Sample: All DNZs except those with a 'mix' of elevations and acquisitions (0.99 > f_elev > 0.01) (n=5275 DNZs) 
```{r include=FALSE}

DS_9 <- subset(DS_all, felev==0 | felev==1)

DS_9b  <- stat.desc(DS_9 , basic=TRUE, 
                     options(scipen=100))

DS_9c <- DS_9b[c("min",
                   "max",
                   "range",
                   "median",
                   "mean",
                   "std.dev"),]

names(DS_9c)<- new_names[names(DS_9c)]
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(DS_9c,
            caption="Descriptive Statistics")

```

#### Descriptive Statistics: 'After 1993' Sample (n=5394 DNZs) 
```{r include=FALSE}

DS_10 <- subset(DS_all, fyDeclared >1993)


DS_10b  <- stat.desc(DS_10 , basic=TRUE, 
                     options(scipen=100, digits=2))

DS_10c <- DS_10b[c("min",
                   "max",
                   "range",
                   "median",
                   "mean",
                   "std.dev"),]

names(DS_10c) <- new_names[names(DS_10c)]
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(DS_10c,
            caption="Descriptive Statistics")

```



#### Descriptive Statistics: Shoreline ZCTA Sample (n=1328 DNZs) 
```{r include=FALSE}

DS_12 <- subset(DS_all, ZCTA_shore ==1)


DS_12b  <- stat.desc(DS_12 , basic=TRUE, 
                     options(scipen=100))

DS_12c <- DS_12b[c("min",
                   "max",
                   "range",
                   "median",
                   "mean",
                   "std.dev"),]

names(DS_12c)<- new_names[names(DS_12c)]

```

```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(DS_12c,
            caption="Descriptive Statistics")

```


#### Descriptive Statistics: 'Sandy' Sample (n=145 DNZs) 
```{r include=FALSE}

DS_13 <- subset(DNZV1, declarationTitle %like% "sandy")

DS_13 <- DS_13[,c("felev",
                   "Elev", "Acqui",
                   "TotPop_W_10k",
                   "PopDense_W_1k", #NEW
                   "fWhite",
                   "fBlack",
                   "fHisp",
                   "MHIadj_W_10k",
                   "MHVadj_W_100k",
                   "TotHU_W_10k",  #NEW
                   "TotOccHU_W_10k", 
                   "RepRate",
                   "mrp_ideology", #NEW
                   "fOwnOcc",
                   "fRentOcc", #NEW
                   "fS2ndHome",  #NEW
                   "TaxBaseEst_1B_W",
                   "ZCTA_shore", 
                   "count_fema_sfha_W_1k",
                   "count_fs_risk_500_year00_W_1k", #NEW
                   "NFIP_ICCadj_YOLZ_W_1M",
                   "NFIP_AllClaimsAdj_YOLZ_W_10M", #NEW
                   "IHP_fldDamAmountAdjDNZ_W_10M",
                   "Hurricane",
                   "fyDeclared")]


DS_13b  <- stat.desc(DS_13 , basic=TRUE, 
                     options(scipen=100))

DS_13c <- DS_13b[c("min",
                   "max",
                   "range",
                   "median",
                   "mean",
                   "std.dev"),]

names(DS_13c)<- new_names[names(DS_13c)]
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(DS_13c,
            caption="Descriptive Statistics")

```

#### Descriptive Statistics: 'Katrina' Sample (n=153 DNZs) 
```{r include=FALSE}

DS_14 <- subset(DNZV1, declarationTitle %like% "katrina")


DS_14 <- DS_14[,c("felev",
                   "Elev", "Acqui",
                   "TotPop_W_10k",
                   "PopDense_W_1k", 
                   "fWhite",
                   "fBlack",
                   "fHisp",
                   "MHIadj_W_10k",
                   "MHVadj_W_100k",
                   "TotHU_W_10k",  
                   "TotOccHU_W_10k", 
                   "RepRate",
                   "mrp_ideology", 
                   "fOwnOcc",
                   "fRentOcc", 
                   "fS2ndHome",  
                   "TaxBaseEst_1B_W",
                   "ZCTA_shore", 
                   "count_fema_sfha_W_1k",
                   "count_fs_risk_500_year00_W_1k", 
                   "NFIP_ICCadj_YOLZ_W_1M",
                   "NFIP_AllClaimsAdj_YOLZ_W_10M", 
                   "IHP_fldDamAmountAdjDNZ_W_10M",
                   "Hurricane",
                   "fyDeclared")]

DS_14b  <- stat.desc(DS_14 , basic=TRUE, 
                     options(scipen=100))

DS_14c <- DS_14b[c("min",
                   "max",
                   "range",
                   "median",
                   "mean",
                   "std.dev"),]

names(DS_14c)<- new_names[names(DS_14c)]
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(DS_14c,
            caption="Descriptive Statistics")

```

## Full sample analysis

### Correlation Matrices

```{r include=FALSE}
cor_fullSample <- cor(DS_all[,sapply(DS_all, is.numeric)])
print(cor_fullSample)


corrplot(cor_fullSample, method = "circle")

```

## Univariate analysis #GOT HERE ####
```{r include=FALSE}
# Chi-Square Test for categorical variables
chisq.test(table(DNZV1$felev, DNZV1$Hurricane)) #Sig
chisq.test(table(DNZV1$felev, DNZV1$ZCTA_shore)) #Sig

# ANOVA for continuous variables
summary(aov(felev ~ TotPop_W_10k, data = DNZV1)) #not sig
summary(aov(felev ~ PopDense_W_1k, data = DNZV1)) #sig
summary(aov(felev ~ fWhite, data = DNZV1)) #sig
summary(aov(felev ~ fBlack, data = DNZV1)) #sig
summary(aov(felev ~ fHisp, data = DNZV1)) #Not sig

```

###########################

#PRIOR ANALYSIS - NEEDS UPDATING

## Welch's Two Sample t-test: 
### Sample comparisons: DNZs with at least 1 Elevation versus DNZs with at least 1 Acquisition
 Of the 4334 DNZs, 217 have a mix of elevations and acquisitions. As such, we create two new variables to identify DNZs with at least 1 elevation (n=867), and DNZs with at least one acquisition (n=3684). While these samples are not perfectly independent given that some have a mix, we conduct two-sample t.tests to estimate whether there is a significant difference in means on the independent variables of interest. For these tests, we (A) compare DNZs with at least 1 elevation to those that have no elevations (only acquisitions: n=3467), and (B) compare DNZs with at least 1 acquisition to those that have no acquisitions (only elevations: n=650)
```{r include=FALSE}
Elev <- subset(DNZV1, Elev>0)
Acqui <- subset(DNZV1, Acqui >0)

DNZV1$AtLeast1Elev <- 0
DNZV1$AtLeast1Elev[DNZV1$Elev>0] <-1 
table(DNZV1$AtLeast1Elev)

DNZV1$AtLeast1Acqui <- 0
DNZV1$AtLeast1Acqui[DNZV1$Acqui>0] <-1 
table(DNZV1$AtLeast1Acqui) 

Mixed <- subset(DNZV1, felev >0 & felev <1) 
sum(Mixed$Elev)
sum(Mixed$Acqui)

sum(DNZV1$Elev)
```


#### Median Home Value: Sample Comparison
```{r include=FALSE}

#library(broom)
#Part A
options(scipen=2)
table(DNZV1$AtLeast1Elev)
t_testA <- t.test(MHVadj_W_100k~AtLeast1Elev, data=DNZV1)
tidy_t_testA <- broom::tidy(t_testA)
tidy_t_testA <- as.data.frame(tidy_t_testA)
names(tidy_t_testA)[names(tidy_t_testA)=="estimate1"] <- "Est.1"
names(tidy_t_testA)[names(tidy_t_testA)=="estimate2"] <- "Est.2"
tidy_t_testA

#Part B
t_testB <- t.test(MHVadj_W_100k~AtLeast1Acqui, data=DNZV1)
tidy_t_testB <- broom::tidy(t_testB)
tidy_t_testB <- as.data.frame(tidy_t_testB)
tidy_t_testB

```

**Results of two-sample t.test:**
*(A): Comparing DNZs with  no elevations (only acquisitions) (estimate 1), to DNZs with at least 1 elevation (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testA)

```
*(B): Comparing DNZs with no acquisition (only elevations) (estimate 1) to DNZs with at leats 1 acquisition (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testB)
```
The results of the two-sample t-tests indicate that there is a significant difference between the two samples in the hypothesized direction. DNZs with at least 1 elevation have a significantly higher MHV than DNZs with only acquisitions (A). DNZs with at least 1 acquisition have a significantly lower MHV than DNZs with only elevations (B). 

#### Fraction White

```{r include=FALSE}

#library(broom)
#Part A
options(scipen=2)
table(DNZV1$AtLeast1Elev)
t_testA <- t.test(fWhite~AtLeast1Elev, data=DNZV1)
tidy_t_testA <- broom::tidy(t_testA)
tidy_t_testA <- as.data.frame(tidy_t_testA)
names(tidy_t_testA)[names(tidy_t_testA)=="estimate1"] <- "Est.1"
names(tidy_t_testA)[names(tidy_t_testA)=="estimate2"] <- "Est.2"
tidy_t_testA

#Part B
t_testB <- t.test(fWhite~AtLeast1Acqui, data=DNZV1)
tidy_t_testB <- broom::tidy(t_testB)
tidy_t_testB <- as.data.frame(tidy_t_testB)
tidy_t_testB

```

**Results of two-sample t.test:**
*(A): Comparing DNZs with  no elevations (only acquisitions) (estimate 1), to DNZs with at least 1 elevation (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testA)
```
*(B): Comparing DNZs with no acquisition (only elevations) (estimate 1) to DNZs with at least 1 acquisition (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testB)
```
The results of the two-sample t-tests indicate that there is a significant difference between the two samples regarding fraction White, but not in the hypothesized direction. DNZs with at least 1 elevation have a significantly lower fraction White on average than DNZs with only acquisitions (A). DNZs with at least 1 acquisition have a significantly higher fraction White than DNZs with only elevations (B). 


#### Politics: County Republican Vote Rate
```{r include=FALSE}

#library(broom)
#Part A
options(scipen=2)
table(DNZV1$AtLeast1Elev)
t_testA <- t.test(RepRate~AtLeast1Elev, data=DNZV1)
tidy_t_testA <- broom::tidy(t_testA)
tidy_t_testA <- as.data.frame(tidy_t_testA)
names(tidy_t_testA)[names(tidy_t_testA)=="estimate1"] <- "Est.1"
names(tidy_t_testA)[names(tidy_t_testA)=="estimate2"] <- "Est.2"
tidy_t_testA

#Part B
t_testB <- t.test(RepRate~AtLeast1Acqui, data=DNZV1)
tidy_t_testB <- broom::tidy(t_testB)
tidy_t_testB <- as.data.frame(tidy_t_testB)
tidy_t_testB
```
**Results of two-sample t.test:**
*(A): Comparing DNZs with  no elevations (only acquisitions) (estimate 1), to DNZs with at least 1 elevation (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testA)
```
*(B): Comparing DNZs with no acquisition (only elevations) (estimate 1) to DNZs with at least 1 acquisition (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testB)
```

The results of the two-sample t-tests indicate that there is no significant difference between the two samples regarding percent the County Republican Vote Rate.

#### ZCTA_shore
```{r echo=FALSE, message=FALSE, warning=FALSE}
ElevByZCTA_shore <- table(DNZV1$AtLeast1Elev,DNZV1$ZCTA_shore)
ElevByZCTA_shore <- ElevByZCTA_shore[2,]
ElevByZCTA_shore <- as.data.frame(ElevByZCTA_shore)
library(Hmisc)
row.names(ElevByZCTA_shore) <- c("Not in ZCTA_shore", "In ZCTA_shore")
colnames(ElevByZCTA_shore) <- c("DNZs with at least 1 Elev")


AcquiByZCTA_shore <- table(DNZV1$AtLeast1Acqui,DNZV1$ZCTA_shore)
AcquiByZCTA_shore <- AcquiByZCTA_shore[2,]
AcquiByZCTA_shore <- as.data.frame(AcquiByZCTA_shore)
library(Hmisc)
row.names(AcquiByZCTA_shore) <- c("Not in ZCTA_shore", "In ZCTA_shore")
colnames(AcquiByZCTA_shore) <- c("DNZs with at least 1 Acquisition")
```

```{r include=FALSE}
knitr::kable(ElevByZCTA_shore)
knitr::kable(AcquiByZCTA_shore)

```

The summary statistics indicate that, of the 867 DNZs with at least 1 elevation, the majority (525) of these DNZs are located in coastal zctas. In contrast, of the 3684 DNZs with at least 1 acquisition, the majority  (3291) are NOT located in coastal shoreline counties.

This lends support to the hypothesis that elevations are a coastal mitigation strategy, relative to buyouts.



#### Hurricane
```{r include = FALSE}
ElevByHurricane <- table(DNZV1$AtLeast1Elev,DNZV1$Hurricane)
ElevByHurricane <- ElevByHurricane[2,]
ElevByHurricane <- as.data.frame(ElevByHurricane)
library(Hmisc)
row.names(ElevByHurricane) <- c("Event is not a Hurricane", "Event is a Hurricane")
colnames(ElevByHurricane) <- c("DNZs with at least 1 Elev")


AcquiByHurricane <- table(DNZV1$AtLeast1Acqui,DNZV1$Hurricane)
AcquiByHurricane <- AcquiByHurricane[2,]
AcquiByHurricane <- as.data.frame(AcquiByHurricane)
library(Hmisc)
row.names(AcquiByHurricane) <- c("Event is not a Hurricane", "Event is a Hurricane")
colnames(AcquiByHurricane) <- c("DNZs with at least 1 Acquisition")
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(ElevByHurricane)
knitr::kable(AcquiByHurricane)

```

The summary statistics indicate that, of the 867 DNZs with at least 1 elevation, the majority (508) of these DNZs are impacted by a hurricane. In contrast, majority of DNZs with at least 1 acquisition (2782) of these DNZs are NOT impacted by hurricanes.

This suggests that hurricanes drive elevations relative to buyouts.


#### Policy incentive: Count of HUs in FEMA SFHA

```{r include=FALSE}

#library(broom)
#Part A
options(scipen=2)
table(DNZV1$AtLeast1Elev)
t_testA <- t.test(count_fema_sfha_W_1k~AtLeast1Elev, data=DNZV1)
tidy_t_testA <- broom::tidy(t_testA)
tidy_t_testA <- as.data.frame(tidy_t_testA)
names(tidy_t_testA)[names(tidy_t_testA)=="estimate1"] <- "Est.1"
names(tidy_t_testA)[names(tidy_t_testA)=="estimate2"] <- "Est.2"
tidy_t_testA

#Part B
t_testB <- t.test(count_fema_sfha_W_1k~AtLeast1Acqui, data=DNZV1)
tidy_t_testB <- broom::tidy(t_testB)
tidy_t_testB <- as.data.frame(tidy_t_testB)
tidy_t_testB

```
**Results of two-sample t.test:**
*(A): Comparing DNZs with  no elevations (only acquisitions) (estimate 1), to DNZs with at least 1 elevation (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testA)
```
*(B): Comparing DNZs with no acquisition (only elevations) (estimate 1) to DNZs with at least 1 acquisition (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testB)
```

The results of the two-sample t-tests indicate that there is a significant difference between the two samples regarding the count of HUs in FEMA SFHA. DNZs with at least 1 elevation have a significantly higher count of HUs in FEMA SFHA on average than DNZs with only acquisitions (A). DNZs with at least 1 acquisition have a significantly lower count of HUs in FEMA SFHA than DNZs with only elevations (B). 


#### Damages: IHP Damage Est. $10M (W)
 
```{r include=FALSE}

#library(broom)
#Part A
options(scipen=2)
table(DNZV1$AtLeast1Elev)
t_testA <- t.test(IHP_fldDamAmountAdjDNZ_W_10M~AtLeast1Elev, data=DNZV1)
tidy_t_testA <- broom::tidy(t_testA)
tidy_t_testA <- as.data.frame(tidy_t_testA)
names(tidy_t_testA)[names(tidy_t_testA)=="estimate1"] <- "Est.1"
names(tidy_t_testA)[names(tidy_t_testA)=="estimate2"] <- "Est.2"
tidy_t_testA

#Part B
t_testB <- t.test(IHP_fldDamAmountAdjDNZ_W_10M~AtLeast1Acqui, data=DNZV1)
tidy_t_testB <- broom::tidy(t_testB)
tidy_t_testB <- as.data.frame(tidy_t_testB)
tidy_t_testB

```

**Results of two-sample t.test:**
*(A): Comparing DNZs with  no elevations (only acquisitions) (estimate 1), to DNZs with at least 1 elevation (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testA)
```
*(B): Comparing DNZs with no acquisition (only elevations) (estimate 1) to DNZs with at least 1 acquisition (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testB)
```

The results of the two-sample t-tests indicate that there is a significant difference between the two samples regarding the IHP Damage Est. DNZs with at least 1 elevation have a significantly higher NFIP Damage Est. on average than DNZs with only acquisitions (A). DNZs with at least 1 acquisition have a significantly lower NFIP Damage Est. than DNZs with only elevations (B). 


#### Total Population 10k (W)

```{r include=FALSE}

#library(broom)
#Part A
options(scipen=2)
table(DNZV1$AtLeast1Elev)
t_testA <- t.test(TotPop_W_10k~AtLeast1Elev, data=DNZV1)
tidy_t_testA <- broom::tidy(t_testA)
tidy_t_testA <- as.data.frame(tidy_t_testA)
names(tidy_t_testA)[names(tidy_t_testA)=="estimate1"] <- "Est.1"
names(tidy_t_testA)[names(tidy_t_testA)=="estimate2"] <- "Est.2"
tidy_t_testA

#Part B
t_testB <- t.test(TotPop_W_10k~AtLeast1Acqui, data=DNZV1)
tidy_t_testB <- broom::tidy(t_testB)
tidy_t_testB <- as.data.frame(tidy_t_testB)
tidy_t_testB

```

**Results of two-sample t.test:**
*(A): Comparing DNZs with  no elevations (only acquisitions) (estimate 1), to DNZs with at least 1 elevation (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testA)
```
*(B): Comparing DNZs with no acquisition (only elevations) (estimate 1) to DNZs with at least 1 acquisition (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testB)
```

The results of the two-sample t-tests indicate that there is no significant difference between the two samples regarding the Total population. 

#### Fraction of Owner Occ. HUs

```{r include=FALSE}

#library(broom)
#Part A
options(scipen=2)
table(DNZV1$AtLeast1Elev)
t_testA <- t.test(fOwnOcc~AtLeast1Elev, data=DNZV1)
tidy_t_testA <- broom::tidy(t_testA)
tidy_t_testA <- as.data.frame(tidy_t_testA)
names(tidy_t_testA)[names(tidy_t_testA)=="estimate1"] <- "Est.1"
names(tidy_t_testA)[names(tidy_t_testA)=="estimate2"] <- "Est.2"
tidy_t_testA

#Part B
t_testB <- t.test(fOwnOcc~AtLeast1Acqui, data=DNZV1)
tidy_t_testB <- broom::tidy(t_testB)
tidy_t_testB <- as.data.frame(tidy_t_testB)
tidy_t_testB

```

**Results of two-sample t.test:**
*(A): Comparing DNZs with  no elevations (only acquisitions) (estimate 1), to DNZs with at least 1 elevation (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testA)
```
*(B): Comparing DNZs with no acquisition (only elevations) (estimate 1) to DNZs with at least 1 acquisition (estimate 2):*
```{r echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(tidy_t_testA)
```

The results of the two-sample t-tests indicate that there is a significant difference between the two samples regarding the Fraction of Owner Occ. HUs:  DNZs with at least 1 elevation have a significantly higher Fraction of Owner Occ. HUs on average than DNZs with only acquisitions (A). DNZs with at least 1 acquisition have a significantly lower Fraction of Owner Occ. HUs than DNZs with only elevations (B). 



## Driving Events
```{r include=FALSE}
aggElevEvent <- aggregate(list(DNZV1$AtLeast1Elev, DNZV1$Elev), by = list(DNZV1$declarationTitle), FUN=sum)
colnames(aggElevEvent) <- c("Event","DNZs With At Least 1 Elevation","Count of Elevations")


aggAcquiEvent <- aggregate(list(DNZV1$AtLeast1Acqui, DNZV1$Acqui), by = list(DNZV1$declarationTitle), FUN=sum)
colnames(aggAcquiEvent) <- c("Event","DNZs With At Least 1 Acquisition","Count of Acquisitions")


PropsByEvent <-  aggregate(list(DNZV1$TotalProps, DNZV1$Acqui, DNZV1$Elev), by = list(DNZV1$declarationTitle), FUN=sum)
colnames(PropsByEvent) <- c("Event","TotalProps", "Acqui","Elev")

##Writing out Table####
#path1 <- 'G:/My Drive/Academic/PhD & Dissertation/Dissertation/Ch1 - FEMA National Study/Graphics'
#write.csv(PropsByEvent, file.path(path1, "PropsByEvent.csv"), row.names=TRUE)

#now creating table of unique named events. Not that later need to add in unnamed events
names(DNZV1)
Event <- DNZV1[,c("Event")]
Event <- as.data.frame(Event)
colnames(Event) <- c("Event")
Event <- unique(Event)
table(Event)
Event2<-subset(Event, Event!="Coastal Storm" &
               Event!="Flood (unnamed)" &
               Event!="Severe Ice Storm (unnamed)" &
               Event!="Severe Storm (unnamed)")

DDbyEvent <- DNZV1[,c("Event","DD")]
names(DDbyEvent)
DDbyEvent <- unique(DDbyEvent)

EventByYear <- left_join(Event2, DDbyEvent, by="Event", copy=FALSE)
EventByYear$Event_Year <- str_c(EventByYear$Event,", ", EventByYear$DD)

##Writing out Table
#path1 <- 'G:/My Drive/Academic/PhD & Dissertation/Dissertation/Ch1 - FEMA National Study/Graphics'
#write.csv(EventByYear, file.path(path1, "EventByYear.csv"), row.names=TRUE)

```


###### Event
```{r include=FALSE}
aggElevEvent <- aggregate(list(DNZV1$AtLeast1Elev, DNZV1$Elev), by = list(DNZV1$Event), FUN=sum)
colnames(aggElevEvent) <- c("Event","DNZs With At Least 1 Elevation","Count of Elevations")


aggAcquiEvent <- aggregate(list(DNZV1$AtLeast1Acqui, DNZV1$Acqui), by = list(DNZV1$Event), FUN=sum)
colnames(aggAcquiEvent) <- c("Event","DNZs With At Least 1 Acquisitions","Count of Acquisitions")

```

```{r echo=FALSE, message=FALSE, warning=FALSE}

knitr::kable(aggElevEvent[order(aggElevEvent$`Count of Elevations`, decreasing = TRUE),])
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data= aggElevEvent %>% slice_max(`Count of Elevations`, n = 10), #This pipe allows you to slice the top 10 data without having to subset it
       aes(fct_reorder(Event, `Count of Elevations`),  #this part orders the columns
           `Count of Elevations`))+
  geom_bar(stat="identity") +
  geom_text(aes(label=`Count of Elevations`, vjust=-0.5))+
  labs(y="Count of Elevations", x="",
               title="Count of HMGP Elevations by Event (1989-2022): Top 10")+
  scale_y_continuous(limits=c(0,13000), labels=scales::comma)+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


```{r echo=FALSE, message=FALSE, warning=FALSE}

knitr::kable(aggAcquiEvent[order(aggAcquiEvent$`Count of Acquisitions`, decreasing = TRUE),])
```


```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(data= aggAcquiEvent %>% slice_max(`Count of Acquisitions`, n = 10), #This pipe allows you to slice the top 10 data without having to subset it
       aes(fct_reorder(Event, `Count of Acquisitions`),  #this part orders the columns
           `Count of Acquisitions`))+
  geom_bar(stat="identity") +
    geom_text(aes(label=`Count of Acquisitions`, vjust=-0.5))+
  labs(y="Count of Acquisitions", x="",
               title="Count of HMGP Acquisitions by Event (1989-2022): Top 10")+
  scale_y_continuous(limits=c(0,13000), labels=scales::comma)+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


```




## Logistic regression of DV against continuous IVs + Decile Bar Charts
Next we explore visualizations of logistic regressions of the DV against the IVs

### Full Sample
```{r include = FALSE}
##GOT HERE####

#using non-winsorized vars:
DNZV1$TotPop_10k <- DNZV1$TotPop / 10000
DNZV1$PopDense_1k <- DNZV1$PopDenseSqMile / 1000
DNZV1$MHIadj_10k <- DNZV1$MHIadj / 10000
DNZV1$TotHU_10k <- DNZV1$TotHU / 10000
DNZV1$TotOccHU_10k <- DNZV1$TotOccHU / 10000
DNZV1$count_fema_sfha_1k <- DNZV1$count_fema_sfha / 1000
DNZV1$NFIP_ICCadj_YOLZ_1M <- DNZV1$NFIP_ICCadj_YOLZ / 1000000
DNZV1$IHP_fldDamAmountAdjDNZ_10M <- DNZV1$IHP_fldDamAmountAdjDNZ /10000000

#Creating deciles:
names(DNZV1)
DNZV1$MHVadj_100k_dec <- NA
DNZV1$MHVadj_100k_dec <- ntile(DNZV1$MHVadj_100k, 10)  
table(DNZV1$MHVadj_100k_dec)
DNZV1$MHVadj_100k_dec <- as.factor(DNZV1$MHVadj_100k_dec)
tapply(DNZV1$MHVadj_100k, DNZV1$MHVadj_100k_dec, summary)
tapply(DNZV1$felev, DNZV1$MHVadj_100k_dec, summary)

DNZV1$fWhite_dec <- NA
DNZV1$fWhite_dec <- ntile(DNZV1$fWhite, 10)  
table(DNZV1$fWhite_dec)
DNZV1$fWhite_dec <- as.factor(DNZV1$fWhite_dec)

DNZV1$RepRate_dec <- NA
DNZV1$RepRate_dec <- ntile(DNZV1$RepRate, 10)  
table(DNZV1$RepRate_dec)
DNZV1$RepRate_dec <- as.factor(DNZV1$RepRate_dec)

DNZV1$ZCTA_shore_dec <- NA
DNZV1$ZCTA_shore_dec <- ntile(DNZV1$ZCTA_shore, 10)  
table(DNZV1$ZCTA_shore_dec)
DNZV1$ZCTA_shore_dec <- as.factor(DNZV1$ZCTA_shore_dec)

DNZV1$count_fema_sfha_1k_dec <- NA
DNZV1$count_fema_sfha_1k_dec <- ntile(DNZV1$count_fema_sfha_1k , 10)  
table(DNZV1$count_fema_sfha_1k_dec)
DNZV1$count_fema_sfha_1k_dec <- as.factor(DNZV1$count_fema_sfha_1k_dec)

DNZV1$NFIP_ICCadj_YOLZ_1M_dec <- NA
DNZV1$NFIP_ICCadj_YOLZ_1M_dec <- ntile(DNZV1$NFIP_ICCadj_YOLZ_1M, 10)  
table(DNZV1$NFIP_ICCadj_YOLZ_1M_dec)
DNZV1$NFIP_ICCadj_YOLZ_1M_dec <- as.factor(DNZV1$NFIP_ICCadj_YOLZ_1M_dec)

DNZV1$IHP_fldDamAmountAdjDNZ_10M_dec <- NA
DNZV1$IHP_fldDamAmountAdjDNZ_10M_dec <- ntile(DNZV1$IHP_fldDamAmountAdjDNZ_10M, 10)  
table(DNZV1$IHP_fldDamAmountAdjDNZ_10M_dec)
DNZV1$IHP_fldDamAmountAdjDNZ_10M_dec <- as.factor(DNZV1$IHP_fldDamAmountAdjDNZ_10M_dec)

DNZV1$Hurricane_dec <- NA
DNZV1$Hurricane_dec <- ntile(DNZV1$Hurricane, 10)  
table(DNZV1$Hurricane_dec)
DNZV1$Hurricane_dec <- as.factor(DNZV1$Hurricane_dec)

DNZV1$TotPop_10k_dec <- NA
DNZV1$TotPop_10k_dec <- ntile(DNZV1$TotPop_10k, 10)  
table(DNZV1$TotPop_10k_dec)
DNZV1$TotPop_10k_dec <- as.factor(DNZV1$TotPop_10k_dec)

DNZV1$fOwnOcc_dec <- NA
DNZV1$fOwnOcc_dec <- ntile(DNZV1$fOwnOcc, 10)  
table(DNZV1$fOwnOcc_dec)
DNZV1$fOwnOcc_dec <- as.factor(DNZV1$fOwnOcc_dec)


```

#### Boxplots
```{r include = FALSE}
B1 <- ggplot(data=DNZV1, aes(x=MHVadj_100k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=12))+
  scale_y_continuous(breaks=c(1,0),
                     labels=c("1: All Elevations","0: All Buyouts"))+
  scale_x_discrete(breaks=c(1,2,3,4,5,6,7,8,9,10),
                     labels=c("1 \n(0-0.7)",
                              "2 \n(0.7-0.9)",
                              "3 \n(0.9-1.0)",
                              "4 \n(1.0-1.2)",
                              "5 \n(1.2-1.3)",
                              "6 \n(1.3-1.5)",
                              "7 \n(1.5-1.7)",
                              "8 \n(1.7-2.0)",
                              "9 \n(2.0-2.7)",
                              "10 \n(2.7-16.0)"))+
  xlab("Median Home Value (100k)")

B2 <- ggplot(data=DNZV1, aes(x=fWhite_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Fraction White")

B3 <- ggplot(data=DNZV1, aes(x=RepRate_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("County Republican Vote Rate")

B4 <-ggplot(data=DNZV1, aes(x=ZCTA_shore_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("ZCTA_shore")

B5 <-ggplot(data=DNZV1, aes(x=count_fema_sfha_1k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Count of HUs in FEMA SFHA (1K)")

B6 <-ggplot(data=DNZV1, aes(x=NFIP_ICCadj_YOLZ_1M_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("NFIP ICC Est. $1M")

B7 <-ggplot(data=DNZV1, aes(x=IHP_fldDamAmountAdjDNZ_10M_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("IHP Damage Est. $10M")

B8 <-ggplot(data=DNZV1, aes(x=Hurricane_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Hurricane")

B9 <-ggplot(data=DNZV1, aes(x=TotPop_10k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Total Population 10k")

B10 <-ggplot(data=DNZV1, aes(x=fOwnOcc_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Fraction of Owner Occ. HUs")

```

```{r include=FALSE}
library(gridExtra)
grid.arrange(B1,B2,B3,B4,B5,B6,B7,B8,B9,B10, ncol=2)

```



#### logit plots
```{r include=FALSE}
#Logistic plots

#MHV
L1 <- ggplot(DNZV1, aes(x=MHVadj_100k, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
    ylab("felev")+
  xlab("Median Home Value (100k)")+
  theme(text = element_text(size=15))+
  scale_y_continuous(breaks=c(1,0),
                     labels=c("1: All Elevations","0: All Buyouts"))


#fwhite
L2 <- ggplot(DNZV1, aes(x=fWhite, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Fraction White")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#RepRate
L3 <- ggplot(DNZV1, aes(x=RepRate, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("County Republican Vote Rate")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#ZCTA_shore
L4 <- ggplot(DNZV1, aes(x=ZCTA_shore, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Shoreline ZCTA")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  scale_x_continuous(breaks=c(1,0))

#Count HUs FEMA SFHA
L5 <- ggplot(DNZV1, aes(x=count_fema_sfha_1k , y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Count of HUs in FEMA SFHA (1K)")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#NFIP ICC
L6 <- ggplot(DNZV1, aes(x=NFIP_ICCadj_YOLZ_1M, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("NFIP ICC Est. $1M")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#IHP Damages
L7 <- ggplot(DNZV1, aes(x=IHP_fldDamAmountAdjDNZ_10M, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("IHP Damage Est. $10M")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#Hurricane
L8 <- ggplot(DNZV1, aes(x=Hurricane, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Hurricane")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  scale_x_continuous(breaks=c(1,0))

#TotPop
L9 <- ggplot(DNZV1, aes(x=TotPop_10k, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Total Population 10k")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#fOwnOcc
L10 <- ggplot(DNZV1, aes(x=fOwnOcc, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Fraction of Owner Occ. HUs")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

```

```{r include=FALSE}
library(gridExtra)
grid.arrange(L1,L2,L3,L4,L5,L6,L7,L8,L9,L10, ncol=2)

```

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(gridExtra)
grid.arrange(L1, B1,ncol=2)

grid.arrange(L1, B1,
             L2, B2,
             L3, B3,
             L4, B4,
             L5, B5,ncol=2)

grid.arrange(L6,B6,
             L7,B7,
             L8,B8,
             L9,B9,
             L10,B10, ncol=2)
```


#### Mean felev by deciles
```{r include = FALSE}
#Mean felev vs decile plots
#library(ggpubr)

#MHV
M1 <- ggerrorplot(data=DNZV1, x = "MHVadj_100k_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Median Home Value (100k)")+
  scale_y_continuous(limits=c(0,1))

#fWhite
M2 <- ggerrorplot(data=DNZV1, x = "fWhite_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Fraction White")+
  scale_y_continuous(limits=c(0,1))

#RepRate
M3 <- ggerrorplot(data=DNZV1, x = "RepRate_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: County Republican Vote Rate")+
  scale_y_continuous(limits=c(0,1))

#ZCTA_shore
M4 <- ggerrorplot(data=DNZV1, x = "ZCTA_shore", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Shoreline ZCTA")+
  scale_y_continuous(limits=c(0,1))

#Count HUs FEMA SFHA
M5 <- ggerrorplot(data=DNZV1, x = "count_fema_sfha_1k_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Count of HUs in FEMA SFHA (1K)")+
  scale_y_continuous(limits=c(0,1))

#NFIP_ICCadj_YOLZ_1M
M6 <- ggerrorplot(data=DNZV1, x = "NFIP_ICCadj_YOLZ_1M_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: NFIP ICC Est. $1M")+
  scale_y_continuous(limits=c(0,1))

#IHP Damages
M7 <- ggerrorplot(data=DNZV1, x = "IHP_fldDamAmountAdjDNZ_10M_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: IHP Damage Est. $10M")+
  scale_y_continuous(limits=c(0,1))

#Hurricane
M8 <- ggerrorplot(data=DNZV1, x = "Hurricane", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Hurricane")+
  scale_y_continuous(limits=c(0,1))


#Total Population
M9 <- ggerrorplot(data=DNZV1, x = "TotPop_10k_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Total Population (10k)")+
  scale_y_continuous(limits=c(0,1))


#fOwnOcc
M10 <- ggerrorplot(data=DNZV1, x = "fOwnOcc_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Fraction of Owner Occ. HUs")+
  scale_y_continuous(limits=c(0,1))

```

```{r include=FALSE}
library(gridExtra)
grid.arrange(M1,M2,M3,M4,M5,M6,M7,M8,M9,M10, ncol=2)

```



### "Less Mix" Sample
```{r include = FALSE}
#using non-winsorized vars:
DNZV1_lessMix$count_fema_sfha_1k <- DNZV1_lessMix$count_fema_sfha / 1000
DNZV1_lessMix$NFIP_ICCadj_YOLZ_1M <- DNZV1_lessMix$NFIP_ICCadj_YOLZ / 1000000
DNZV1_lessMix$IHP_fldDamAmountAdjDNZ_10M <- DNZV1_lessMix$IHP_fldDamAmountAdjDNZ /10000000
DNZV1_lessMix$TotPop_10k <- DNZV1_lessMix$TotPop / 10000

#Creating deciles:
DNZV1_lessMix$MHVadj_100k_dec <- NA
DNZV1_lessMix$MHVadj_100k_dec <- ntile(DNZV1_lessMix$MHVadj_100k, 10)  
table(DNZV1_lessMix$MHVadj_100k_dec)
DNZV1_lessMix$MHVadj_100k_dec <- as.factor(DNZV1_lessMix$MHVadj_100k_dec)
tapply(DNZV1_lessMix$MHVadj_100k, DNZV1_lessMix$MHVadj_100k_dec, summary)
tapply(DNZV1_lessMix$felev, DNZV1_lessMix$MHVadj_100k_dec, summary)

DNZV1_lessMix$fWhite_dec <- NA
DNZV1_lessMix$fWhite_dec <- ntile(DNZV1_lessMix$fWhite, 10)  
table(DNZV1_lessMix$fWhite_dec)
DNZV1_lessMix$fWhite_dec <- as.factor(DNZV1_lessMix$fWhite_dec)

DNZV1_lessMix$RepRate_dec <- NA
DNZV1_lessMix$RepRate_dec <- ntile(DNZV1_lessMix$RepRate, 10)  
table(DNZV1_lessMix$RepRate_dec)
DNZV1_lessMix$RepRate_dec <- as.factor(DNZV1_lessMix$RepRate_dec)

DNZV1_lessMix$ZCTA_shore_dec <- NA
DNZV1_lessMix$ZCTA_shore_dec <- ntile(DNZV1_lessMix$ZCTA_shore, 10)  
table(DNZV1_lessMix$ZCTA_shore_dec)
DNZV1_lessMix$ZCTA_shore_dec <- as.factor(DNZV1_lessMix$ZCTA_shore_dec)

DNZV1_lessMix$count_fema_sfha_1k_dec <- NA
DNZV1_lessMix$count_fema_sfha_1k_dec <- ntile(DNZV1_lessMix$count_fema_sfha_1k , 10)  
table(DNZV1_lessMix$count_fema_sfha_1k_dec)
DNZV1_lessMix$count_fema_sfha_1k_dec <- as.factor(DNZV1_lessMix$count_fema_sfha_1k_dec)

DNZV1_lessMix$NFIP_ICCadj_YOLZ_1M_dec <- NA
DNZV1_lessMix$NFIP_ICCadj_YOLZ_1M_dec <- ntile(DNZV1_lessMix$NFIP_ICCadj_YOLZ_1M, 10)  
table(DNZV1_lessMix$NFIP_ICCadj_YOLZ_1M_dec)
DNZV1_lessMix$NFIP_ICCadj_YOLZ_1M_dec <- as.factor(DNZV1_lessMix$NFIP_ICCadj_YOLZ_1M_dec)

DNZV1_lessMix$IHP_fldDamAmountAdjDNZ_10M_dec <- NA
DNZV1_lessMix$IHP_fldDamAmountAdjDNZ_10M_dec <- ntile(DNZV1_lessMix$IHP_fldDamAmountAdjDNZ_10M, 10)  
table(DNZV1_lessMix$IHP_fldDamAmountAdjDNZ_10M_dec)
DNZV1_lessMix$IHP_fldDamAmountAdjDNZ_10M_dec <- as.factor(DNZV1_lessMix$IHP_fldDamAmountAdjDNZ_10M_dec)

DNZV1_lessMix$Hurricane_dec <- NA
DNZV1_lessMix$Hurricane_dec <- ntile(DNZV1_lessMix$Hurricane, 10)  
table(DNZV1_lessMix$Hurricane_dec)
DNZV1_lessMix$Hurricane_dec <- as.factor(DNZV1_lessMix$Hurricane_dec)

DNZV1_lessMix$TotPop_10k_dec <- NA
DNZV1_lessMix$TotPop_10k_dec <- ntile(DNZV1_lessMix$TotPop_10k, 10)  
table(DNZV1_lessMix$TotPop_10k_dec)
DNZV1_lessMix$TotPop_10k_dec <- as.factor(DNZV1_lessMix$TotPop_10k_dec)

DNZV1_lessMix$fOwnOcc_dec <- NA
DNZV1_lessMix$fOwnOcc_dec <- ntile(DNZV1_lessMix$fOwnOcc, 10)  
table(DNZV1_lessMix$fOwnOcc_dec)
DNZV1_lessMix$fOwnOcc_dec <- as.factor(DNZV1_lessMix$fOwnOcc_dec)


```

```{r include = FALSE}
B1 <- ggplot(data=DNZV1_lessMix, aes(x=MHVadj_100k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("MHV Deciles")

B2 <- ggplot(data=DNZV1_lessMix, aes(x=fWhite_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("fWhite Deciles")

B3 <- ggplot(data=DNZV1_lessMix, aes(x=RepRate_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("RepRate Deciles")

B4 <-ggplot(data=DNZV1_lessMix, aes(x=ZCTA_shore_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("ZCTA_shore Deciles")

B5 <-ggplot(data=DNZV1_lessMix, aes(x=count_fema_sfha_1k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("FEMA SFHA Deciles")

B6 <-ggplot(data=DNZV1_lessMix, aes(x=NFIP_ICCadj_YOLZ_1M_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("NFIP ICC Deciles")

B7 <-ggplot(data=DNZV1_lessMix, aes(x=IHP_fldDamAmountAdjDNZ_10M_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("IHP damage Deciles")

B8 <-ggplot(data=DNZV1_lessMix, aes(x=Hurricane_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Hurricane Deciles")

B9 <-ggplot(data=DNZV1_lessMix, aes(x=TotPop_10k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Tot. Pop. Deciles")

B10 <-ggplot(data=DNZV1_lessMix, aes(x=fOwnOcc_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("fOwnOcc Deciles")

```


```{r include=FALSE}
#Logistic plots

#MHV
L1 <- ggplot(DNZV1_lessMix, aes(x=MHVadj_100k, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("MHV 100k")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))


#fwhite
L2 <- ggplot(DNZV1_lessMix, aes(x=fWhite, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Fraction White")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#RepRate
L3 <- ggplot(DNZV1_lessMix, aes(x=RepRate, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("County Republican Vote Rate")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#ZCTA_shore
L4 <- ggplot(DNZV1_lessMix, aes(x=ZCTA_shore, y=felev))+
  geom_point()+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("ZCTA_shore")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  scale_x_continuous(breaks=c(1,0))

#Count HUs FEMA SFHA
L5 <- ggplot(DNZV1_lessMix, aes(x=count_fema_sfha_1k , y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Count of HUs in FEMA SFHA (1K)")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#NFIP ICC
L6 <- ggplot(DNZV1_lessMix, aes(x=NFIP_ICCadj_YOLZ_1M, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("NFIP ICC Est. $1M (W)")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#IHP Damages
L7 <- ggplot(DNZV1_lessMix, aes(x=IHP_fldDamAmountAdjDNZ_10M, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("IHP Damage Est. $10M")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#Hurricane
L8 <- ggplot(DNZV1_lessMix, aes(x=Hurricane, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Hurricane")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  scale_x_continuous(breaks=c(1,0))

#TotPop
L9 <- ggplot(DNZV1_lessMix, aes(x=TotPop_10k, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Total Population 10k")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#fOwnOcc
L10 <- ggplot(DNZV1_lessMix, aes(x=fOwnOcc, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Fraction of Owner Occ. HUs")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

```


```{r echo=FALSE, message=FALSE, warning=FALSE}
library(gridExtra)
grid.arrange(L1, B1,
             L2, B2,
             L3, B3,
             L4, B4,
             L5, B5,ncol=2)

grid.arrange(L6,B6,
             L7,B7,
             L8,B8,
             L9,B9,
             L10,B10, ncol=2)
```


### After 1993 Sample
```{r include = FALSE}
DNZV1_After1993$count_fema_sfha_1k <- DNZV1_After1993$count_fema_sfha / 1000
DNZV1_After1993$NFIP_ICCadj_YOLZ_1M <- DNZV1_After1993$NFIP_ICCadj_YOLZ / 1000000
DNZV1_After1993$IHP_fldDamAmountAdjDNZ_10M <- DNZV1_After1993$IHP_fldDamAmountAdjDNZ /10000000
DNZV1_After1993$TotPop_10k <- DNZV1_After1993$TotPop / 10000

#Creating deciles:
DNZV1_After1993$MHVadj_100k_dec <- NA
DNZV1_After1993$MHVadj_100k_dec <- ntile(DNZV1_After1993$MHVadj_100k, 10)  
table(DNZV1_After1993$MHVadj_100k_dec)
DNZV1_After1993$MHVadj_100k_dec <- as.factor(DNZV1_After1993$MHVadj_100k_dec)
tapply(DNZV1_After1993$MHVadj_100k, DNZV1_After1993$MHVadj_100k_dec, summary)
tapply(DNZV1_After1993$felev, DNZV1_After1993$MHVadj_100k_dec, summary)

DNZV1_After1993$fWhite_dec <- NA
DNZV1_After1993$fWhite_dec <- ntile(DNZV1_After1993$fWhite, 10)  
table(DNZV1_After1993$fWhite_dec)
DNZV1_After1993$fWhite_dec <- as.factor(DNZV1_After1993$fWhite_dec)

DNZV1_After1993$RepRate_dec <- NA
DNZV1_After1993$RepRate_dec <- ntile(DNZV1_After1993$RepRate, 10)  
table(DNZV1_After1993$RepRate_dec)
DNZV1_After1993$RepRate_dec <- as.factor(DNZV1_After1993$RepRate_dec)

DNZV1_After1993$ZCTA_shore_dec <- NA
DNZV1_After1993$ZCTA_shore_dec <- ntile(DNZV1_After1993$ZCTA_shore, 10)  
table(DNZV1_After1993$ZCTA_shore_dec)
DNZV1_After1993$ZCTA_shore_dec <- as.factor(DNZV1_After1993$ZCTA_shore_dec)

DNZV1_After1993$count_fema_sfha_1k_dec <- NA
DNZV1_After1993$count_fema_sfha_1k_dec <- ntile(DNZV1_After1993$count_fema_sfha_1k , 10)  
table(DNZV1_After1993$count_fema_sfha_1k_dec)
DNZV1_After1993$count_fema_sfha_1k_dec <- as.factor(DNZV1_After1993$count_fema_sfha_1k_dec)

DNZV1_After1993$NFIP_ICCadj_YOLZ_1M_dec <- NA
DNZV1_After1993$NFIP_ICCadj_YOLZ_1M_dec <- ntile(DNZV1_After1993$NFIP_ICCadj_YOLZ_1M, 10)  
table(DNZV1_After1993$NFIP_ICCadj_YOLZ_1M_dec)
DNZV1_After1993$NFIP_ICCadj_YOLZ_1M_dec <- as.factor(DNZV1_After1993$NFIP_ICCadj_YOLZ_1M_dec)

DNZV1_After1993$IHP_fldDamAmountAdjDNZ_10M_dec <- NA
DNZV1_After1993$IHP_fldDamAmountAdjDNZ_10M_dec <- ntile(DNZV1_After1993$IHP_fldDamAmountAdjDNZ_10M, 10)  
table(DNZV1_After1993$IHP_fldDamAmountAdjDNZ_10M_dec)
DNZV1_After1993$IHP_fldDamAmountAdjDNZ_10M_dec <- as.factor(DNZV1_After1993$IHP_fldDamAmountAdjDNZ_10M_dec)

DNZV1_After1993$Hurricane_dec <- NA
DNZV1_After1993$Hurricane_dec <- ntile(DNZV1_After1993$Hurricane, 10)  
table(DNZV1_After1993$Hurricane_dec)
DNZV1_After1993$Hurricane_dec <- as.factor(DNZV1_After1993$Hurricane_dec)

DNZV1_After1993$TotPop_10k_dec <- NA
DNZV1_After1993$TotPop_10k_dec <- ntile(DNZV1_After1993$TotPop_10k, 10)  
table(DNZV1_After1993$TotPop_10k_dec)
DNZV1_After1993$TotPop_10k_dec <- as.factor(DNZV1_After1993$TotPop_10k_dec)

DNZV1_After1993$fOwnOcc_dec <- NA
DNZV1_After1993$fOwnOcc_dec <- ntile(DNZV1_After1993$fOwnOcc, 10)  
table(DNZV1_After1993$fOwnOcc_dec)
DNZV1_After1993$fOwnOcc_dec <- as.factor(DNZV1_After1993$fOwnOcc_dec)


```

```{r include = FALSE}
B1 <- ggplot(data=DNZV1_After1993, aes(x=MHVadj_100k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("MHV Deciles")

B2 <- ggplot(data=DNZV1_After1993, aes(x=fWhite_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("fWhite Deciles")

B3 <- ggplot(data=DNZV1_After1993, aes(x=RepRate_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("RepRate Deciles")

B4 <-ggplot(data=DNZV1_After1993, aes(x=ZCTA_shore_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("ZCTA_shore Deciles")

B5 <-ggplot(data=DNZV1_After1993, aes(x=count_fema_sfha_1k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("FEMA SFHA Deciles")

B6 <-ggplot(data=DNZV1_After1993, aes(x=NFIP_ICCadj_YOLZ_1M_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("NFIP ICC Deciles")

B7 <-ggplot(data=DNZV1_After1993, aes(x=IHP_fldDamAmountAdjDNZ_10M_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("IHP damage Deciles")

B8 <-ggplot(data=DNZV1_After1993, aes(x=Hurricane_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Hurricane Deciles")

B9 <-ggplot(data=DNZV1_After1993, aes(x=TotPop_10k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Tot. Pop. Deciles")

B10 <-ggplot(data=DNZV1_After1993, aes(x=fOwnOcc_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("fOwnOcc Deciles")

```


```{r include=FALSE}
#Logistic plots

#MHV
L1 <- ggplot(DNZV1_After1993, aes(x=MHVadj_100k, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("MHV 100k")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))


#fwhite
L2 <- ggplot(DNZV1_After1993, aes(x=fWhite, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Fraction White")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#RepRate
L3 <- ggplot(DNZV1_After1993, aes(x=RepRate, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("County Republican Vote Rate")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#ZCTA_shore
L4 <- ggplot(DNZV1_After1993, aes(x=ZCTA_shore, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("ZCTA_shore")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  scale_x_continuous(breaks=c(1,0))

#Count HUs FEMA SFHA
L5 <- ggplot(DNZV1_After1993, aes(x=count_fema_sfha_1k , y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Count of HUs in FEMA SFHA (1K)")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#NFIP ICC
L6 <- ggplot(DNZV1_After1993, aes(x=NFIP_ICCadj_YOLZ_1M, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("NFIP ICC Est. $1M (W)")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#IHP Damages
L7 <- ggplot(DNZV1_After1993, aes(x=IHP_fldDamAmountAdjDNZ_10M, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("IHP Damage Est. $10M")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#Hurricane
L8 <- ggplot(DNZV1_After1993, aes(x=Hurricane, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Hurricane")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  scale_x_continuous(breaks=c(1,0))

#TotPop
L9 <- ggplot(DNZV1_After1993, aes(x=TotPop_10k, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Total Population 10k")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#fOwnOcc
L10 <- ggplot(DNZV1_After1993, aes(x=fOwnOcc, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Fraction of Owner Occ. HUs")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

```


```{r echo=FALSE, message=FALSE, warning=FALSE}
library(gridExtra)
grid.arrange(L1, B1,
             L2, B2,
             L3, B3,
             L4, B4,
             L5, B5,ncol=2)

grid.arrange(L6,B6,
             L7,B7,
             L8,B8,
             L9,B9,
             L10,B10, ncol=2)
```


### ZCTA_shore Sample
```{r include = FALSE}
DNZV1_ZCTA_shore$count_fema_sfha_1k <- DNZV1_ZCTA_shore$count_fema_sfha / 1000
DNZV1_ZCTA_shore$NFIP_ICCadj_YOLZ_1M <- DNZV1_ZCTA_shore$NFIP_ICCadj_YOLZ / 1000000
DNZV1_ZCTA_shore$IHP_fldDamAmountAdjDNZ_10M <- DNZV1_ZCTA_shore$IHP_fldDamAmountAdjDNZ /10000000
DNZV1_ZCTA_shore$TotPop_10k <- DNZV1_ZCTA_shore$TotPop / 10000

#Creating deciles:
DNZV1_ZCTA_shore$MHVadj_100k_dec <- NA
DNZV1_ZCTA_shore$MHVadj_100k_dec <- ntile(DNZV1_ZCTA_shore$MHVadj_100k, 10)  
table(DNZV1_ZCTA_shore$MHVadj_100k_dec)
DNZV1_ZCTA_shore$MHVadj_100k_dec <- as.factor(DNZV1_ZCTA_shore$MHVadj_100k_dec)
tapply(DNZV1_ZCTA_shore$MHVadj_100k, DNZV1_ZCTA_shore$MHVadj_100k_dec, summary)
tapply(DNZV1_ZCTA_shore$felev, DNZV1_ZCTA_shore$MHVadj_100k_dec, summary)

DNZV1_ZCTA_shore$fWhite_dec <- NA
DNZV1_ZCTA_shore$fWhite_dec <- ntile(DNZV1_ZCTA_shore$fWhite, 10)  
table(DNZV1_ZCTA_shore$fWhite_dec)
DNZV1_ZCTA_shore$fWhite_dec <- as.factor(DNZV1_ZCTA_shore$fWhite_dec)

DNZV1_ZCTA_shore$RepRate_dec <- NA
DNZV1_ZCTA_shore$RepRate_dec <- ntile(DNZV1_ZCTA_shore$RepRate, 10)  
table(DNZV1_ZCTA_shore$RepRate_dec)
DNZV1_ZCTA_shore$RepRate_dec <- as.factor(DNZV1_ZCTA_shore$RepRate_dec)

DNZV1_ZCTA_shore$ZCTA_shore_dec <- NA
DNZV1_ZCTA_shore$ZCTA_shore_dec <- ntile(DNZV1_ZCTA_shore$ZCTA_shore, 10)  
table(DNZV1_ZCTA_shore$ZCTA_shore_dec)
DNZV1_ZCTA_shore$ZCTA_shore_dec <- as.factor(DNZV1_ZCTA_shore$ZCTA_shore_dec)

DNZV1_ZCTA_shore$count_fema_sfha_1k_dec <- NA
DNZV1_ZCTA_shore$count_fema_sfha_1k_dec <- ntile(DNZV1_ZCTA_shore$count_fema_sfha_1k , 10)  
table(DNZV1_ZCTA_shore$count_fema_sfha_1k_dec)
DNZV1_ZCTA_shore$count_fema_sfha_1k_dec <- as.factor(DNZV1_ZCTA_shore$count_fema_sfha_1k_dec)

DNZV1_ZCTA_shore$NFIP_ICCadj_YOLZ_1M_dec <- NA
DNZV1_ZCTA_shore$NFIP_ICCadj_YOLZ_1M_dec <- ntile(DNZV1_ZCTA_shore$NFIP_ICCadj_YOLZ_1M, 10)  
table(DNZV1_ZCTA_shore$NFIP_ICCadj_YOLZ_1M_dec)
DNZV1_ZCTA_shore$NFIP_ICCadj_YOLZ_1M_dec <- as.factor(DNZV1_ZCTA_shore$NFIP_ICCadj_YOLZ_1M_dec)

DNZV1_ZCTA_shore$IHP_fldDamAmountAdjDNZ_10M_dec <- NA
DNZV1_ZCTA_shore$IHP_fldDamAmountAdjDNZ_10M_dec <- ntile(DNZV1_ZCTA_shore$IHP_fldDamAmountAdjDNZ_10M, 10)  
table(DNZV1_ZCTA_shore$IHP_fldDamAmountAdjDNZ_10M_dec)
DNZV1_ZCTA_shore$IHP_fldDamAmountAdjDNZ_10M_dec <- as.factor(DNZV1_ZCTA_shore$IHP_fldDamAmountAdjDNZ_10M_dec)

DNZV1_ZCTA_shore$Hurricane_dec <- NA
DNZV1_ZCTA_shore$Hurricane_dec <- ntile(DNZV1_ZCTA_shore$Hurricane, 10)  
table(DNZV1_ZCTA_shore$Hurricane_dec)
DNZV1_ZCTA_shore$Hurricane_dec <- as.factor(DNZV1_ZCTA_shore$Hurricane_dec)

DNZV1_ZCTA_shore$TotPop_10k_dec <- NA
DNZV1_ZCTA_shore$TotPop_10k_dec <- ntile(DNZV1_ZCTA_shore$TotPop_10k, 10)  
table(DNZV1_ZCTA_shore$TotPop_10k_dec)
DNZV1_ZCTA_shore$TotPop_10k_dec <- as.factor(DNZV1_ZCTA_shore$TotPop_10k_dec)

DNZV1_ZCTA_shore$fOwnOcc_dec <- NA
DNZV1_ZCTA_shore$fOwnOcc_dec <- ntile(DNZV1_ZCTA_shore$fOwnOcc, 10)  
table(DNZV1_ZCTA_shore$fOwnOcc_dec)
DNZV1_ZCTA_shore$fOwnOcc_dec <- as.factor(DNZV1_ZCTA_shore$fOwnOcc_dec)


```

```{r include = FALSE}
B1 <- ggplot(data=DNZV1_ZCTA_shore, aes(x=MHVadj_100k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("MHV 100k")

B2 <- ggplot(data=DNZV1_ZCTA_shore, aes(x=fWhite_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Fraction White")

B3 <- ggplot(data=DNZV1_ZCTA_shore, aes(x=RepRate_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("County Republican Vote Rate")

B4 <-ggplot(data=DNZV1_ZCTA_shore, aes(x=ZCTA_shore_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("ZCTA_shore")

B5 <-ggplot(data=DNZV1_ZCTA_shore, aes(x=count_fema_sfha_1k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Count of HUs in FEMA SFHA (1K)")

B6 <-ggplot(data=DNZV1_ZCTA_shore, aes(x=NFIP_ICCadj_YOLZ_1M_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("NFIP ICC Est. $1M")

B7 <-ggplot(data=DNZV1_ZCTA_shore, aes(x=IHP_fldDamAmountAdjDNZ_10M_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("IHP Damage Est. $10M")

B8 <-ggplot(data=DNZV1_ZCTA_shore, aes(x=Hurricane_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Hurricane")

B9 <-ggplot(data=DNZV1_ZCTA_shore, aes(x=TotPop_10k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Total Population 10k")

B10 <-ggplot(data=DNZV1_ZCTA_shore, aes(x=fOwnOcc_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Fraction of Owner Occ. HUs")

```

```{r include=FALSE}
library(gridExtra)
grid.arrange(B1,B2,B3,B4,B5,B6,B7,B8,B9,B10, ncol=2)

```


```{r include=FALSE}
#Logistic plots

#MHV
L1 <- ggplot(DNZV1_ZCTA_shore, aes(x=MHVadj_100k, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("MHV 100k")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))


#fwhite
L2 <- ggplot(DNZV1_ZCTA_shore, aes(x=fWhite, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Fraction White")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#RepRate
L3 <- ggplot(DNZV1_ZCTA_shore, aes(x=RepRate, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("County Republican Vote Rate")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#ZCTA_shore
L4 <- ggplot(DNZV1_ZCTA_shore, aes(x=ZCTA_shore, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("ZCTA_shore")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  scale_x_continuous(breaks=c(1,0))

#Count HUs FEMA SFHA
L5 <- ggplot(DNZV1_ZCTA_shore, aes(x=count_fema_sfha_1k , y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Count of HUs in FEMA SFHA (1K)")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#NFIP ICC
L6 <- ggplot(DNZV1_ZCTA_shore, aes(x=NFIP_ICCadj_YOLZ_1M, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("NFIP ICC Est. $1M")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#IHP Damages
L7 <- ggplot(DNZV1_ZCTA_shore, aes(x=IHP_fldDamAmountAdjDNZ_10M, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("IHP Damage Est. $10M")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#Hurricane
L8 <- ggplot(DNZV1_ZCTA_shore, aes(x=Hurricane, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Hurricane")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  scale_x_continuous(breaks=c(1,0))

#TotPop
L9 <- ggplot(DNZV1_ZCTA_shore, aes(x=TotPop_10k, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Total Population 10k")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#fOwnOcc
L10 <- ggplot(DNZV1_ZCTA_shore, aes(x=fOwnOcc, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Fraction of Owner Occ. HUs")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

```


```{r include=FALSE}
library(gridExtra)
grid.arrange(L1,L2,L3,L4,L5,L6,L7,L8,L9,L10, ncol=2)

```


```{r echo=FALSE, message=FALSE, warning=FALSE}
library(gridExtra)
grid.arrange(L1, B1,
             L2, B2,
             L3, B3,
             L5, B5, ncol=2)

grid.arrange(L6,B6,
             L7,B7,
             L8,B8,
             L9,B9,
             L10,B10, ncol=2)
```

#### Mean felev by deciles
```{r include = FALSE}
#Mean felev vs decile plots
#library(ggpubr)

#MHV
M1 <- ggerrorplot(data=DNZV1_ZCTA_shore, x = "MHVadj_100k_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Median Home Value (100k)")+
  scale_y_continuous(limits=c(0,1))

#fWhite
M2 <- ggerrorplot(data=DNZV1_ZCTA_shore, x = "fWhite_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Fraction White")+
  scale_y_continuous(limits=c(0,1))

#RepRate
M3 <- ggerrorplot(data=DNZV1_ZCTA_shore, x = "RepRate_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: County Republican Vote Rate")+
  scale_y_continuous(limits=c(0,1))

#ZCTA_shore


#Count HUs FEMA SFHA
M5 <- ggerrorplot(data=DNZV1_ZCTA_shore, x = "count_fema_sfha_1k_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Count of HUs in FEMA SFHA (1K)")+
  scale_y_continuous(limits=c(0,1))

#NFIP_ICCadj_YOLZ_1M
M6 <- ggerrorplot(data=DNZV1_ZCTA_shore, x = "NFIP_ICCadj_YOLZ_1M_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: NFIP ICC Est. $1M")+
  scale_y_continuous(limits=c(0,1))

#IHP Damages
M7 <- ggerrorplot(data=DNZV1_ZCTA_shore, x = "IHP_fldDamAmountAdjDNZ_10M_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: IHP Damage Est. $10M")+
  scale_y_continuous(limits=c(0,1))

#Hurricane
M8 <- ggerrorplot(data=DNZV1_ZCTA_shore, x = "Hurricane", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Hurricane")+
  scale_y_continuous(limits=c(0,1))


#Total Population
M9 <- ggerrorplot(data=DNZV1_ZCTA_shore, x = "TotPop_10k_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Total Population (10k)")+
  scale_y_continuous(limits=c(0,1))


#fOwnOcc
M10 <- ggerrorplot(data=DNZV1_ZCTA_shore, x = "fOwnOcc_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Fraction of Owner Occ. HUs")+
  scale_y_continuous(limits=c(0,1))

```

```{r include=FALSE}
library(gridExtra)
grid.arrange(M1,M2,M3,M5,M6,M7,M8,M9,M10, ncol=2)

```


### Sandy Sample
```{r include = FALSE}
DNZV1_Sandy$count_fema_sfha_1k <- DNZV1_Sandy$count_fema_sfha / 1000
DNZV1_Sandy$NFIP_ICCadj_YOLZ_1M <- DNZV1_Sandy$NFIP_ICCadj_YOLZ / 1000000
DNZV1_Sandy$IHP_fldDamAmountAdjDNZ_10M <- DNZV1_Sandy$IHP_fldDamAmountAdjDNZ /10000000
DNZV1_Sandy$TotPop_10k <- DNZV1_Sandy$TotPop / 10000

#Creating deciles:
DNZV1_Sandy$MHVadj_100k_dec <- NA
DNZV1_Sandy$MHVadj_100k_dec <- ntile(DNZV1_Sandy$MHVadj_100k, 10)  
table(DNZV1_Sandy$MHVadj_100k_dec)
DNZV1_Sandy$MHVadj_100k_dec <- as.factor(DNZV1_Sandy$MHVadj_100k_dec)
tapply(DNZV1_Sandy$MHVadj_100k, DNZV1_Sandy$MHVadj_100k_dec, summary)
tapply(DNZV1_Sandy$felev, DNZV1_Sandy$MHVadj_100k_dec, summary)

DNZV1_Sandy$fWhite_dec <- NA
DNZV1_Sandy$fWhite_dec <- ntile(DNZV1_Sandy$fWhite, 10)  
table(DNZV1_Sandy$fWhite_dec)
DNZV1_Sandy$fWhite_dec <- as.factor(DNZV1_Sandy$fWhite_dec)

DNZV1_Sandy$RepRate_dec <- NA
DNZV1_Sandy$RepRate_dec <- ntile(DNZV1_Sandy$RepRate, 10)  
table(DNZV1_Sandy$RepRate_dec)
DNZV1_Sandy$RepRate_dec <- as.factor(DNZV1_Sandy$RepRate_dec)

DNZV1_Sandy$ZCTA_shore_dec <- NA
DNZV1_Sandy$ZCTA_shore_dec <- ntile(DNZV1_Sandy$ZCTA_shore, 10)  
table(DNZV1_Sandy$ZCTA_shore_dec)
DNZV1_Sandy$ZCTA_shore_dec <- as.factor(DNZV1_Sandy$ZCTA_shore_dec)

DNZV1_Sandy$count_fema_sfha_1k_dec <- NA
DNZV1_Sandy$count_fema_sfha_1k_dec <- ntile(DNZV1_Sandy$count_fema_sfha_1k , 10)  
table(DNZV1_Sandy$count_fema_sfha_1k_dec)
DNZV1_Sandy$count_fema_sfha_1k_dec <- as.factor(DNZV1_Sandy$count_fema_sfha_1k_dec)

DNZV1_Sandy$NFIP_ICCadj_YOLZ_1M_dec <- NA
DNZV1_Sandy$NFIP_ICCadj_YOLZ_1M_dec <- ntile(DNZV1_Sandy$NFIP_ICCadj_YOLZ_1M, 10)  
table(DNZV1_Sandy$NFIP_ICCadj_YOLZ_1M_dec)
DNZV1_Sandy$NFIP_ICCadj_YOLZ_1M_dec <- as.factor(DNZV1_Sandy$NFIP_ICCadj_YOLZ_1M_dec)

DNZV1_Sandy$IHP_fldDamAmountAdjDNZ_10M_dec <- NA
DNZV1_Sandy$IHP_fldDamAmountAdjDNZ_10M_dec <- ntile(DNZV1_Sandy$IHP_fldDamAmountAdjDNZ_10M, 10)  
table(DNZV1_Sandy$IHP_fldDamAmountAdjDNZ_10M_dec)
DNZV1_Sandy$IHP_fldDamAmountAdjDNZ_10M_dec <- as.factor(DNZV1_Sandy$IHP_fldDamAmountAdjDNZ_10M_dec)

DNZV1_Sandy$Hurricane_dec <- NA
DNZV1_Sandy$Hurricane_dec <- ntile(DNZV1_Sandy$Hurricane, 10)  
table(DNZV1_Sandy$Hurricane_dec)
DNZV1_Sandy$Hurricane_dec <- as.factor(DNZV1_Sandy$Hurricane_dec)

DNZV1_Sandy$TotPop_10k_dec <- NA
DNZV1_Sandy$TotPop_10k_dec <- ntile(DNZV1_Sandy$TotPop_10k, 10)  
table(DNZV1_Sandy$TotPop_10k_dec)
DNZV1_Sandy$TotPop_10k_dec <- as.factor(DNZV1_Sandy$TotPop_10k_dec)

DNZV1_Sandy$fOwnOcc_dec <- NA
DNZV1_Sandy$fOwnOcc_dec <- ntile(DNZV1_Sandy$fOwnOcc, 10)  
table(DNZV1_Sandy$fOwnOcc_dec)
DNZV1_Sandy$fOwnOcc_dec <- as.factor(DNZV1_Sandy$fOwnOcc_dec)


```

```{r include = FALSE}
B1 <- ggplot(data=DNZV1_Sandy, aes(x=MHVadj_100k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("MHV Dec.")

B2 <- ggplot(data=DNZV1_Sandy, aes(x=fWhite_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Fraction White Dec.")

B3 <- ggplot(data=DNZV1_Sandy, aes(x=RepRate_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Cnty Rep. Vote Rate Dec.")

B4 <-ggplot(data=DNZV1_Sandy, aes(x=ZCTA_shore_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Coastal Shoreline County Dec.")

B5 <-ggplot(data=DNZV1_Sandy, aes(x=count_fema_sfha_1k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("FEMA SFHA Dec.")

B6 <-ggplot(data=DNZV1_Sandy, aes(x=NFIP_ICCadj_YOLZ_1M_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("NFIP ICC Dec.")

B7 <-ggplot(data=DNZV1_Sandy, aes(x=IHP_fldDamAmountAdjDNZ_10M_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("IHP Damage Est. $10M Dec.")

B8 <-ggplot(data=DNZV1_Sandy, aes(x=Hurricane_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Hurricane Dec.")

B9 <-ggplot(data=DNZV1_Sandy, aes(x=TotPop_10k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Tot. Pop. 10k Dec.")

B10 <-ggplot(data=DNZV1_Sandy, aes(x=fOwnOcc_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Fraction HUs Own. Occ Dec.")

```


```{r include=FALSE}
#Logistic plots

#MHV
L1 <- ggplot(DNZV1_Sandy, aes(x=MHVadj_100k, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("MHV 100k")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))


#fwhite
L2 <- ggplot(DNZV1_Sandy, aes(x=fWhite, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Fraction White")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#RepRate
L3 <- ggplot(DNZV1_Sandy, aes(x=RepRate, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("County Republican Vote Rate")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#ZCTA_shore
L4 <- ggplot(DNZV1_Sandy, aes(x=ZCTA_shore, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Shoreline ZCTA")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  scale_x_continuous(breaks=c(1,0))

#Count HUs FEMA SFHA
L5 <- ggplot(DNZV1_Sandy, aes(x=count_fema_sfha_1k , y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Count of HUs in FEMA SFHA (1K)")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#NFIP ICC
L6 <- ggplot(DNZV1_Sandy, aes(x=NFIP_ICCadj_YOLZ_1M, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("NFIP ICC Est. $1M")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#IHP Damages
L7 <- ggplot(DNZV1_Sandy, aes(x=IHP_fldDamAmountAdjDNZ_10M, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("IHP Damage Est. $10M")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#Hurricane
L8 <- ggplot(DNZV1_Sandy, aes(x=Hurricane, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Hurricane")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  scale_x_continuous(breaks=c(1,0))

#TotPop
L9 <- ggplot(DNZV1_Sandy, aes(x=TotPop_10k, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Total Population 10k")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#fOwnOcc
L10 <- ggplot(DNZV1_Sandy, aes(x=fOwnOcc, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Fraction of Owner Occ. HUs")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

```

```{r include=FALSE}
library(gridExtra)
grid.arrange(L1, L2, L3,L4,L5,L6,L7,L9,L10,ncol=5)

```

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(gridExtra)
grid.arrange(L1, B1,
             L2, B2,
             L3, B3,
             L4, B4,
             L5, B5,ncol=2)

grid.arrange(L6,B6,
             L7,B7,
             L9,B9,
             L10,B10, ncol=2)
```


#### Mean felev by deciles
```{r include = FALSE}
#Mean felev vs decile plots
#library(ggpubr)

#MHV
M1 <- ggerrorplot(data=DNZV1_Sandy, x = "MHVadj_100k_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Median Home Value (100k)")+
  scale_y_continuous(limits=c(0,1))

#fWhite
M2 <- ggerrorplot(data=DNZV1_Sandy, x = "fWhite_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Fraction White")+
  scale_y_continuous(limits=c(0,1))

#RepRate
M3 <- ggerrorplot(data=DNZV1_Sandy, x = "RepRate_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: County Republican Vote Rate")+
  scale_y_continuous(limits=c(0,1))

#ZCTA_shore
M4 <- ggerrorplot(data=DNZV1_Sandy, x = "ZCTA_shore", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Shoreline ZCTA")+
  scale_y_continuous(limits=c(0,1))

#Count HUs FEMA SFHA
M5 <- ggerrorplot(data=DNZV1_Sandy, x = "count_fema_sfha_1k_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Count of HUs in FEMA SFHA (1K)")+
  scale_y_continuous(limits=c(0,1))

#NFIP_ICCadj_YOLZ_1M
M6 <- ggerrorplot(data=DNZV1_Sandy, x = "NFIP_ICCadj_YOLZ_1M_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: NFIP ICC Est. $1M")+
  scale_y_continuous(limits=c(0,1))

#IHP Damages
M7 <- ggerrorplot(data=DNZV1_Sandy, x = "IHP_fldDamAmountAdjDNZ_10M_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: IHP Damage Est. $10M")+
  scale_y_continuous(limits=c(0,1))

#Hurricane
M8 <- ggerrorplot(data=DNZV1_Sandy, x = "Hurricane", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Hurricane")+
  scale_y_continuous(limits=c(0,1))


#Total Population
M9 <- ggerrorplot(data=DNZV1_Sandy, x = "TotPop_10k_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Total Population (10k)")+
  scale_y_continuous(limits=c(0,1))


#fOwnOcc
M10 <- ggerrorplot(data=DNZV1_Sandy, x = "fOwnOcc_dec", y = "felev", 
            desc_stat = "mean_se",
            error.plot="errorbar",
            add="mean")+
  ylab("Mean felev")+
  xlab("Deciles: Fraction of Owner Occ. HUs")+
  scale_y_continuous(limits=c(0,1))

```

```{r include=FALSE}
library(gridExtra)
grid.arrange(M1,M2,M3,M4,M5,M6,M7,M9,M10, ncol=2)

```




### Katrina Sample
```{r include = FALSE}
DNZV1_Katrina$count_fema_sfha_1k <- DNZV1_Katrina$count_fema_sfha / 1000
DNZV1_Katrina$NFIP_ICCadj_YOLZ_1M <- DNZV1_Katrina$NFIP_ICCadj_YOLZ / 1000000
DNZV1_Katrina$IHP_fldDamAmountAdjDNZ_10M <- DNZV1_Katrina$IHP_fldDamAmountAdjDNZ /10000000
DNZV1_Katrina$TotPop_10k <- DNZV1_Katrina$TotPop / 10000

#Creating deciles:
DNZV1_Katrina$MHVadj_100k_dec <- NA
DNZV1_Katrina$MHVadj_100k_dec <- ntile(DNZV1_Katrina$MHVadj_100k, 10)  
table(DNZV1_Katrina$MHVadj_100k_dec)
DNZV1_Katrina$MHVadj_100k_dec <- as.factor(DNZV1_Katrina$MHVadj_100k_dec)
tapply(DNZV1_Katrina$MHVadj_100k, DNZV1_Katrina$MHVadj_100k_dec, summary)
tapply(DNZV1_Katrina$felev, DNZV1_Katrina$MHVadj_100k_dec, summary)

DNZV1_Katrina$fWhite_dec <- NA
DNZV1_Katrina$fWhite_dec <- ntile(DNZV1_Katrina$fWhite, 10)  
table(DNZV1_Katrina$fWhite_dec)
DNZV1_Katrina$fWhite_dec <- as.factor(DNZV1_Katrina$fWhite_dec)

DNZV1_Katrina$RepRate_dec <- NA
DNZV1_Katrina$RepRate_dec <- ntile(DNZV1_Katrina$RepRate, 10)  
table(DNZV1_Katrina$RepRate_dec)
DNZV1_Katrina$RepRate_dec <- as.factor(DNZV1_Katrina$RepRate_dec)

DNZV1_Katrina$ZCTA_shore_dec <- NA
DNZV1_Katrina$ZCTA_shore_dec <- ntile(DNZV1_Katrina$ZCTA_shore, 10)  
table(DNZV1_Katrina$ZCTA_shore_dec)
DNZV1_Katrina$ZCTA_shore_dec <- as.factor(DNZV1_Katrina$ZCTA_shore_dec)

DNZV1_Katrina$count_fema_sfha_1k_dec <- NA
DNZV1_Katrina$count_fema_sfha_1k_dec <- ntile(DNZV1_Katrina$count_fema_sfha_1k , 10)  
table(DNZV1_Katrina$count_fema_sfha_1k_dec)
DNZV1_Katrina$count_fema_sfha_1k_dec <- as.factor(DNZV1_Katrina$count_fema_sfha_1k_dec)

DNZV1_Katrina$NFIP_ICCadj_YOLZ_1M_dec <- NA
DNZV1_Katrina$NFIP_ICCadj_YOLZ_1M_dec <- ntile(DNZV1_Katrina$NFIP_ICCadj_YOLZ_1M, 10)  
table(DNZV1_Katrina$NFIP_ICCadj_YOLZ_1M_dec)
DNZV1_Katrina$NFIP_ICCadj_YOLZ_1M_dec <- as.factor(DNZV1_Katrina$NFIP_ICCadj_YOLZ_1M_dec)

DNZV1_Katrina$IHP_fldDamAmountAdjDNZ_10M_dec <- NA
DNZV1_Katrina$IHP_fldDamAmountAdjDNZ_10M_dec <- ntile(DNZV1_Katrina$IHP_fldDamAmountAdjDNZ_10M, 10)  
table(DNZV1_Katrina$IHP_fldDamAmountAdjDNZ_10M_dec)
DNZV1_Katrina$IHP_fldDamAmountAdjDNZ_10M_dec <- as.factor(DNZV1_Katrina$IHP_fldDamAmountAdjDNZ_10M_dec)

DNZV1_Katrina$Hurricane_dec <- NA
DNZV1_Katrina$Hurricane_dec <- ntile(DNZV1_Katrina$Hurricane, 10)  
table(DNZV1_Katrina$Hurricane_dec)
DNZV1_Katrina$Hurricane_dec <- as.factor(DNZV1_Katrina$Hurricane_dec)

DNZV1_Katrina$TotPop_10k_dec <- NA
DNZV1_Katrina$TotPop_10k_dec <- ntile(DNZV1_Katrina$TotPop_10k, 10)  
table(DNZV1_Katrina$TotPop_10k_dec)
DNZV1_Katrina$TotPop_10k_dec <- as.factor(DNZV1_Katrina$TotPop_10k_dec)

DNZV1_Katrina$fOwnOcc_dec <- NA
DNZV1_Katrina$fOwnOcc_dec <- ntile(DNZV1_Katrina$fOwnOcc, 10)  
table(DNZV1_Katrina$fOwnOcc_dec)
DNZV1_Katrina$fOwnOcc_dec <- as.factor(DNZV1_Katrina$fOwnOcc_dec)


```

```{r include = FALSE}
B1 <- ggplot(data=DNZV1_Katrina, aes(x=MHVadj_100k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("MHV Deciles")

B2 <- ggplot(data=DNZV1_Katrina, aes(x=fWhite_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("fWhite Deciles")

B3 <- ggplot(data=DNZV1_Katrina, aes(x=RepRate_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("RepRate Deciles")

B4 <-ggplot(data=DNZV1_Katrina, aes(x=ZCTA_shore_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("ZCTA_shore Deciles")

B5 <-ggplot(data=DNZV1_Katrina, aes(x=count_fema_sfha_1k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("FEMA SFHA Deciles")

B6 <-ggplot(data=DNZV1_Katrina, aes(x=NFIP_ICCadj_YOLZ_1M_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("NFIP ICC Deciles")

B7 <-ggplot(data=DNZV1_Katrina, aes(x=IHP_fldDamAmountAdjDNZ_10M_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("IHP damage Deciles")

B8 <-ggplot(data=DNZV1_Katrina, aes(x=Hurricane_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Hurricane Deciles")

B9 <-ggplot(data=DNZV1_Katrina, aes(x=TotPop_10k_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("Tot. Pop. Deciles")

B10 <-ggplot(data=DNZV1_Katrina, aes(x=fOwnOcc_dec, y=felev))+
  geom_boxplot(outlier.shape = NA)+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  xlab("fOwnOcc Deciles")

```


```{r include=FALSE}
#Logistic plots

#MHV
L1 <- ggplot(DNZV1_Katrina, aes(x=MHVadj_100k, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("MHV 100k")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))


#fwhite
L2 <- ggplot(DNZV1_Katrina, aes(x=fWhite, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Fraction White")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#RepRate
L3 <- ggplot(DNZV1_Katrina, aes(x=RepRate, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("County Republican Vote Rate")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#ZCTA_shore
L4 <- ggplot(DNZV1_Katrina, aes(x=ZCTA_shore, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("ZCTA_shore")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  scale_x_continuous(breaks=c(1,0))

#Count HUs FEMA SFHA
L5 <- ggplot(DNZV1_Katrina, aes(x=count_fema_sfha_1k , y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Count of HUs in FEMA SFHA (1K)")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#NFIP ICC
L6 <- ggplot(DNZV1_Katrina, aes(x=NFIP_ICCadj_YOLZ_1M, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("NFIP ICC Est. $1M")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#IHP Damages
L7 <- ggplot(DNZV1_Katrina, aes(x=IHP_fldDamAmountAdjDNZ_10M, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("IHP Damage Est. $10M")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#Hurricane
L8 <- ggplot(DNZV1_Katrina, aes(x=Hurricane, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Hurricane")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))+
  scale_x_continuous(breaks=c(1,0))

#TotPop
L9 <- ggplot(DNZV1_Katrina, aes(x=TotPop_10k, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Total Population 10k")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

#fOwnOcc
L10 <- ggplot(DNZV1_Katrina, aes(x=fOwnOcc, y=felev))+
  geom_point(alpha = 0.10)+
  stat_smooth(method = "glm", method.args = list(family=binomial), col="magenta")+
  ylab("felev")+
  xlab("Fraction of Owner Occ. HUs")+
  theme(text = element_text(size=8))+
  scale_y_continuous(breaks=c(1,0))

```


```{r echo=FALSE, message=FALSE, warning=FALSE}
library(gridExtra)
grid.arrange(L1, B1,
             L2, B2,
             L3, B3,
             L4, B4,
             L5, B5,ncol=2)

grid.arrange(L6,B6,
             L7,B7,
             L9,B9,
             L10,B10, ncol=2)
```

## Pearson's Correlation Matrix of IVs: 
### Pearson: Full Sample
```{r include=FALSE}
##Corr plot
names(DNZV1)

IVs1<- DNZV1[,c("MHVadj_W_100k",
                   "fWhite",
                   "RepRate",
                   "ZCTA_shore", 
                   "count_fema_sfha_W_1k",
                   "NFIP_ICCadj_YOLZ_W_1M",
                   "IHP_fldDamAmountAdjDNZ_W_10M",
                   "Hurricane",
                   "TotPop_W_10k",
                   "fOwnOcc"
               )]


names(IVs1)[names(IVs1)=="felev"]<- "felev"
names(IVs1)[names(IVs1)=="MHVadj_W_100k"]<- "Median Home Value $100k (W)"
names(IVs1)[names(IVs1)=="fWhite"]<- "Fraction White"
names(IVs1)[names(IVs1)=="ZCTA_shore"]<- "Shoreline ZCTA"
names(IVs1)[names(IVs1)=="RepRate"]<- "County Republican Vote Rate"
names(IVs1)[names(IVs1)=="SevereStorm"]<- "Severe Storm"
names(IVs1)[names(IVs1)=="count_fema_sfha_W_1k"]<- "Count of HUs in FEMA SFHA 1k (W)"
names(IVs1)[names(IVs1)=="NFIP_AllClaimsAdj_YOLZ_W_10M"]<- "NFIP Damage Est. $10M (W)"
names(IVs1)[names(IVs1)=="NFIP_ICCadj_YOLZ_W_1M"]<- "NFIP ICC Est. $1M (W)"
names(IVs1)[names(IVs1)=="IHP_fldDamAmountAdjDNZ_W_10M"]<- "IHP Damage Est. $10M (W)"
names(IVs1)[names(IVs1)=="TotPop_W_10k"]<- "Total Population 10k (W)"
names(IVs1)[names(IVs1)=="fOwnOcc"]<- "Fraction of Owner Occ. HUs"


```

```{r echo=FALSE}
corrplot(cor(IVs1),method="color", type="lower",
         addCoef.col = "black", 
         number.cex= 0.75, 
         tl.cex=0.75, tl.col="black")

```

### Pearson: "Less Mix" Sample
```{r include=FALSE}
##Corr plot
names(DNZV1_lessMix)

IVs1<- DNZV1_lessMix[,c("MHVadj_W_100k",
                   "fWhite",
                   "RepRate",
                   "ZCTA_shore", 
                   "count_fema_sfha_W_1k",
                   "NFIP_ICCadj_YOLZ_W_1M",
                   "IHP_fldDamAmountAdjDNZ_W_10M",
                   "Hurricane",
                   "TotPop_W_10k",
                   "fOwnOcc"
               )]


names(IVs1)[names(IVs1)=="felev"]<- "felev"
names(IVs1)[names(IVs1)=="MHVadj_W_100k"]<- "Median Home Value $100k (W)"
names(IVs1)[names(IVs1)=="fWhite"]<- "Fraction White"
names(IVs1)[names(IVs1)=="ZCTA_shore"]<- "Shoreline ZCTA"
names(IVs1)[names(IVs1)=="RepRate"]<- "County Republican Vote Rate"
names(IVs1)[names(IVs1)=="SevereStorm"]<- "Severe Storm"
names(IVs1)[names(IVs1)=="count_fema_sfha_W_1k"]<- "Count of HUs in FEMA SFHA 1k (W)"
names(IVs1)[names(IVs1)=="NFIP_AllClaimsAdj_YOLZ_W_10M"]<- "NFIP Damage Est. $10M (W)"
names(IVs1)[names(IVs1)=="NFIP_ICCadj_YOLZ_W_1M"]<- "NFIP ICC Est. $1M (W)"
names(IVs1)[names(IVs1)=="IHP_fldDamAmountAdjDNZ_W_10M"]<- "IHP Damage Est. $10M (W)"
names(IVs1)[names(IVs1)=="TotPop_W_10k"]<- "Total Population 10k (W)"
names(IVs1)[names(IVs1)=="fOwnOcc"]<- "Fraction of Owner Occ. HUs"


```

```{r echo=FALSE}
corrplot(cor(IVs1),method="color", type="lower",
         addCoef.col = "black", 
         number.cex= 0.75, 
         tl.cex=0.75, tl.col="black")

```


### Pearson: "After 1993" Sample
```{r include=FALSE}
##Corr plot
IVs1<- DNZV1_After1993[,c("MHVadj_W_100k",
                   "fWhite",
                   "RepRate",
                   "ZCTA_shore", 
                   "count_fema_sfha_W_1k",
                   "NFIP_ICCadj_YOLZ_W_1M",
                   "IHP_fldDamAmountAdjDNZ_W_10M",
                   "Hurricane",
                   "TotPop_W_10k",
                   "fOwnOcc"
               )]


names(IVs1)[names(IVs1)=="felev"]<- "felev"
names(IVs1)[names(IVs1)=="MHVadj_W_100k"]<- "Median Home Value $100k (W)"
names(IVs1)[names(IVs1)=="fWhite"]<- "Fraction White"
names(IVs1)[names(IVs1)=="ZCTA_shore"]<- "Shoreline ZCTA"
names(IVs1)[names(IVs1)=="RepRate"]<- "County Republican Vote Rate"
names(IVs1)[names(IVs1)=="SevereStorm"]<- "Severe Storm"
names(IVs1)[names(IVs1)=="count_fema_sfha_W_1k"]<- "Count of HUs in FEMA SFHA 1k (W)"
names(IVs1)[names(IVs1)=="NFIP_AllClaimsAdj_YOLZ_W_10M"]<- "NFIP Damage Est. $10M (W)"
names(IVs1)[names(IVs1)=="NFIP_ICCadj_YOLZ_W_1M"]<- "NFIP ICC Est. $1M (W)"
names(IVs1)[names(IVs1)=="IHP_fldDamAmountAdjDNZ_W_10M"]<- "IHP Damage Est. $10M (W)"
names(IVs1)[names(IVs1)=="TotPop_W_10k"]<- "Total Population 10k (W)"
names(IVs1)[names(IVs1)=="fOwnOcc"]<- "Fraction of Owner Occ. HUs"


```

```{r echo=FALSE}
corrplot(cor(IVs1),method="color", type="lower",
         addCoef.col = "black", 
         number.cex= 0.75, 
         tl.cex=0.75, tl.col="black")

```


### Pearson ZCTA_shore Sample
```{r include=FALSE}
##Corr plot
names(DNZV1)

IVs1<- DNZV1_ZCTA_shore[,c("MHVadj_W_100k",
                   "fWhite",
                   "RepRate",
                   "count_fema_sfha_W_1k",
                   #"NFIP_ICCadj_YOLZ_W_1M",
                   "IHP_fldDamAmountAdjDNZ_W_10M"
                   #"Hurricane",
                   #"TotPop_W_10k",
                   #"fOwnOcc"
               )]


names(IVs1)[names(IVs1)=="felev"]<- "felev"
names(IVs1)[names(IVs1)=="MHVadj_W_100k"]<- "Median Home Value $100k (W)"
names(IVs1)[names(IVs1)=="fWhite"]<- "Fraction White"
names(IVs1)[names(IVs1)=="ZCTA_shore"]<- "Shoreline ZCTA"
names(IVs1)[names(IVs1)=="RepRate"]<- "County Republican Vote Rate"
names(IVs1)[names(IVs1)=="SevereStorm"]<- "Severe Storm"
names(IVs1)[names(IVs1)=="count_fema_sfha_W_1k"]<- "Count of HUs in FEMA SFHA 1k (W)"
names(IVs1)[names(IVs1)=="NFIP_AllClaimsAdj_YOLZ_W_10M"]<- "NFIP Damage Est. $10M (W)"
names(IVs1)[names(IVs1)=="NFIP_ICCadj_YOLZ_W_1M"]<- "NFIP ICC Est. $1M (W)"
names(IVs1)[names(IVs1)=="IHP_fldDamAmountAdjDNZ_W_10M"]<- "IHP Damage Est. $10M (W)"
names(IVs1)[names(IVs1)=="TotPop_W_10k"]<- "Total Population 10k (W)"
names(IVs1)[names(IVs1)=="fOwnOcc"]<- "Fraction of Owner Occ. HUs"


```

```{r echo=FALSE}
corrplot(cor(IVs1),method="color", type="lower",
         addCoef.col = "black", 
         number.cex= 0.75, 
         tl.cex=0.75, tl.col="black")


```


### Pearson Sandy Sample
```{r include=FALSE}
##Corr plot
names(DNZV1)

IVs1<- DNZV1_Sandy[,c("MHVadj_W_100k",
                   "fWhite",
                   "RepRate",
                   "ZCTA_shore",
                   "count_fema_sfha_W_1k",
                   "NFIP_ICCadj_YOLZ_W_1M",
                   "IHP_fldDamAmountAdjDNZ_W_10M",
                   "TotPop_W_10k",
                   "fOwnOcc"
               )]


names(IVs1)[names(IVs1)=="felev"]<- "felev"
names(IVs1)[names(IVs1)=="MHVadj_W_100k"]<- "Median Home Value $100k (W)"
names(IVs1)[names(IVs1)=="fWhite"]<- "Fraction White"
names(IVs1)[names(IVs1)=="ZCTA_shore"]<- "Shoreline ZCTA"
names(IVs1)[names(IVs1)=="RepRate"]<- "County Republican Vote Rate"
names(IVs1)[names(IVs1)=="SevereStorm"]<- "Severe Storm"
names(IVs1)[names(IVs1)=="count_fema_sfha_W_1k"]<- "Count of HUs in FEMA SFHA 1k (W)"
names(IVs1)[names(IVs1)=="NFIP_AllClaimsAdj_YOLZ_W_10M"]<- "NFIP Damage Est. $10M (W)"
names(IVs1)[names(IVs1)=="NFIP_ICCadj_YOLZ_W_1M"]<- "NFIP ICC Est. $1M (W)"
names(IVs1)[names(IVs1)=="IHP_fldDamAmountAdjDNZ_W_10M"]<- "IHP Damage Est. $10M (W)"
names(IVs1)[names(IVs1)=="TotPop_W_10k"]<- "Total Population 10k (W)"
names(IVs1)[names(IVs1)=="fOwnOcc"]<- "Fraction of Owner Occ. HUs"


```

```{r echo=FALSE}
corrplot(cor(IVs1),method="color", type="lower",
         addCoef.col = "black", 
         number.cex= 0.75, 
         tl.cex=0.75, tl.col="black")


```


### Pearson Katrina Sample
```{r include=FALSE}
##Corr plot
names(DNZV1)

IVs1<- DNZV1_Katrina[,c("MHVadj_W_100k",
                   "fWhite",
                   "RepRate",
                   "ZCTA_shore",
                   "count_fema_sfha_W_1k",
                   "NFIP_ICCadj_YOLZ_W_1M",
                   "IHP_fldDamAmountAdjDNZ_W_10M",
                   "TotPop_W_10k",
                   "fOwnOcc"
               )]


names(IVs1)[names(IVs1)=="felev"]<- "felev"
names(IVs1)[names(IVs1)=="MHVadj_W_100k"]<- "Median Home Value $100k (W)"
names(IVs1)[names(IVs1)=="fWhite"]<- "Fraction White"
names(IVs1)[names(IVs1)=="ZCTA_shore"]<- "Shoreline ZCTA"
names(IVs1)[names(IVs1)=="RepRate"]<- "County Republican Vote Rate"
names(IVs1)[names(IVs1)=="SevereStorm"]<- "Severe Storm"
names(IVs1)[names(IVs1)=="count_fema_sfha_W_1k"]<- "Count of HUs in FEMA SFHA 1k (W)"
names(IVs1)[names(IVs1)=="NFIP_AllClaimsAdj_YOLZ_W_10M"]<- "NFIP Damage Est. $10M (W)"
names(IVs1)[names(IVs1)=="NFIP_ICCadj_YOLZ_W_1M"]<- "NFIP ICC Est. $1M (W)"
names(IVs1)[names(IVs1)=="IHP_fldDamAmountAdjDNZ_W_10M"]<- "IHP Damage Est. $10M (W)"
names(IVs1)[names(IVs1)=="TotPop_W_10k"]<- "Total Population 10k (W)"
names(IVs1)[names(IVs1)=="fOwnOcc"]<- "Fraction of Owner Occ. HUs"


```

```{r echo=FALSE}
corrplot(cor(IVs1),method="color", type="lower",
         addCoef.col = "black", 
         number.cex= 0.75, 
         tl.cex=0.75, tl.col="black")


```

